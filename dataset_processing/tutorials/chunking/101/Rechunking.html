
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Rechunking &#8212; HyTEST Project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dataset_processing/tutorials/chunking/101/Rechunking';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Advanced Topics in Chunking" href="../201/index.html" />
    <link rel="prev" title="Writing Chunked Files" href="WriteChunkedFiles.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">v0.0.1_alpha01</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../doc/About.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/HyTEST_Badge.svg" class="logo__image only-light" alt="HyTEST Project - Home"/>
    <script>document.write(`<img src="../../../../_static/HyTEST_Badge.svg" class="logo__image only-dark" alt="HyTEST Project - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment Set-Up</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../environment_set_up/README.html">Compute Environments</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/QuickStart-General.html">General QuickStart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/QuickStart-Cloud-Nebari.html">Cloud: Nebari Quick-Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/OpenOnDemand.html">HPC Server: Open OnDemand Quick-Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/JupyterForward.html">HPC Server: Jupyter Forward Quick-Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/StartScript.html">HPC Server: Start Script Quick-Start</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../environment_set_up/Help_AWS_Credentials.html">AWS Credentials</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../environment_set_up/clusters.html">Starting a Dask Cluster</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/Start_Dask_Cluster_Nebari.html">Nebari Dask Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/Start_Dask_Cluster_Denali.html">Denali HPC Dask Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/Start_Dask_Cluster_Tallgrass.html">Hovenweep/Tallgrass HPC Dask Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../environment_set_up/Start_Dask_Cluster_Desktop.html">Local Desktop Dask Cluster</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../essential_reading/README.html">Essential Reading</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../essential_reading/ReadingsTutorials.html">Foundations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../essential_reading/DataSources/README.html">Data Sources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../essential_reading/DataSources/Data_APIs.html">Data/APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../essential_reading/DataSources/Data_S3.html">Data/Cloud Storage</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../essential_reading/Parallel_Dask.html">Parallelism with Dask</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dataset Access</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dataset_catalog/README.html">HyTEST Data Catalog (Intake)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dataset_catalog/subcatalogs/README.html">HyTEST Intake Sub-Catalogs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../dataset_catalog/STAC.html">USGS Water Mission Area STAC Catalog</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dataset_access/CONUS404_ACCESS.html">CONUS404 Products Data Access</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dataset_access/CONUS404_CHANGELOG.html">CONUS404 Zarr Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../dataset_access/conus404_explore.html">Explore CONUS404 Dataset</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Zarr Creation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Data Chunking Tutorial Overview</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Introduction to Chunking</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="WhyChunk.html">Why (re)Chunk Data?</a></li>
<li class="toctree-l2"><a class="reference internal" href="ExamineDataChunking.html">How to Examine a Stored Dataset’s Chunk Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="BasicsShapeSize.html">Basics of Chunk Shape and Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="WriteChunkedFiles.html">Writing Chunked Files</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Rechunking</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../201/index.html">Advanced Topics in Chunking</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../201/RechunkingwithDask.html">Rechunking Larger Datasets with Dask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../201/CreateVirtualZarr.html">Generating a Virtual Zarr Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../201/IncludeCRSinZarr.html">Adding Coordinate Reference Systems (CRS) to Zarr Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../201/OptimalChunkSelection.html">Choosing an Optimal Chunk Size and Shape</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../back/index.html">Chunking References</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../back/Glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../back/AdditionalResources.html">Additional Resources</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dataset Processing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../conus404_temporal_aggregation.html">CONUS404 Temporal Aggregation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../spatial_aggregation.html">Spatial Aggregation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../spatial_aggregation/conus404_spatial_aggregation_DRB.html">gdptools CONUS404 Spatial Aggregation over DRB-extent HUC12s</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spatial_aggregation/conus404_spatial_aggregation_GFv1_1.html">gdptools CONUS404 Spatial Aggregation over CONUS-extent GFv1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spatial_aggregation/conus404_spatial_aggregation_WBD12.html">gdptools CONUS404 Spatial Aggregation over CONUS-extent HUC12s</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spatial_aggregation/conus404_spatial_aggregation.html">Pangeo CONUS404 Spatial Aggregation over DRB-extent HUC12s</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spatial_aggregation/conus404_spatial_aggregation_comparison.html">gdptools-Pangeo Method Comparison for CONUS404 Spatial Aggregation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../conus404_point_selection.html">CONUS404 Site Data Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conus404_regrid.html">CONUS404 Regridding (Curvilinear =&gt; Rectilinear)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Evaluation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../evaluation/metrics.html">Evaluation Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/Metrics_DScore_Suite_v1.html">D-Score Suite (v1) Benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/tutorials/stats_demos/Usage_DScore_Suite_v1.html">D-Score Suite (v1) Benchmark – Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/Metrics_StdSuite_v1.html">Standard Suite (v1) Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/tutorials/stats_demos/Usage_StdSuite_v1.html">Standard Suite (v1) Metrics – Usage Examples</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../evaluation/tutorials/streamflow/00_Overview.html">Streamflow Model Evaluation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/tutorials/streamflow/01_Data_Prep.html">Streamflow Eval :: Data Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/tutorials/streamflow/02_Analysis_StdSuite.html">Streamflow Eval :: StdSuite Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/tutorials/streamflow/02_Analysis_DScore.html">Steamflow Eval :: DScore Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../evaluation/tutorials/streamflow/03_Vizualization.html">Streamflow Eval :: Visualization</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../LICENSE.html">License</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/hytest-org/hytest" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/dataset_processing/tutorials/chunking/101/Rechunking.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Rechunking</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-a-zarr-store">Read in a Zarr Store</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-current-chunk-shape-and-size">Check the Current Chunk Shape and Size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-a-new-chunk-shape-and-size">Choose a New Chunk Shape and Size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rechunk-with-rechunker">Rechunk with Rechunker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confirm-the-creation-of-the-zarr-store-by-rechunker">Confirm the Creation of the Zarr Store by Rechunker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-up">Clean Up</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="rechunking">
<h1>Rechunking<a class="headerlink" href="#rechunking" title="Link to this heading">#</a></h1>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This notebook was inspired by the material in <a class="reference external" href="https://github.com/NCAR/rechunk_retro_nwm_v21/blob/main/notebooks/usage_example_rerechunk_chrtout.ipynb">this notebook by James McCreight</a>, and <a class="reference external" href="https://rechunker.readthedocs.io/en/latest/tutorial.html">the Rechunker Tutorial</a>.</p>
</div>
</aside>
<p>The goal of this notebook is to learn how to “<a class="reference internal" href="../back/Glossary.html#term-Rechunking"><span class="std std-ref"><strong>rechunk</strong></span></a>” data.
This will be a culmination of all the <a class="reference internal" href="index.html"><span class="std std-doc">previous introductory material</span></a> where we will:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ExamineDataChunking.html"><span class="std std-doc">Read in a Zarr store</span></a></p></li>
<li><p><a class="reference internal" href="ExamineDataChunking.html"><span class="std std-doc">Check the current chunking</span></a></p></li>
<li><p><a class="reference internal" href="BasicsShapeSize.html"><span class="std std-doc">Choose a new chunk shape</span></a></p></li>
<li><p>Rechunk using <a class="reference external" href="https://rechunker.readthedocs.io/en/latest/index.html">Rechunker</a></p></li>
<li><p><a class="reference internal" href="WriteChunkedFiles.html"><span class="std std-doc">Confirm the proper creation of the Zarr store by Rechunker</span></a></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">xmode</span> Minimal
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rechunker</span><span class="w"> </span><span class="kn">import</span> <span class="n">rechunk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception reporting mode: Minimal
</pre></div>
</div>
</div>
</div>
<section id="read-in-a-zarr-store">
<h2>Read in a Zarr Store<a class="headerlink" href="#read-in-a-zarr-store" title="Link to this heading">#</a></h2>
<p>For the dataset in this tutorial, we will use the data from the National Water Model Reanalysis Version 2.1.
The full dataset is part of the <a class="reference external" href="https://aws.amazon.com/opendata/">AWS Open Data Program</a>, available via the S3 bucket at: <code class="docutils literal notranslate"><span class="pre">s3://noaa-nwm-retro-v2-zarr-pds/</span></code>.</p>
<p>As this is a Zarr store, we can easily read it in directly with <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.open_dataset.html"><code class="docutils literal notranslate"><span class="pre">xarray.open_dataset()</span></code></a>, including the keyword <code class="docutils literal notranslate"><span class="pre">chunks={}</span></code> to make sure dask loads the data using the stored chunks’ shape and size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">get_mapper</span><span class="p">(</span><span class="s1">&#39;s3://noaa-nwm-retro-v2-zarr-pds&#39;</span><span class="p">,</span> <span class="n">anon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{},</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;zarr&#39;</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 35TB
Dimensions:         (time: 227904, feature_id: 2729077)
Coordinates:
  * feature_id      (feature_id) int32 11MB 101 179 ... 1180001803 1180001804
    latitude        (feature_id) float32 11MB dask.array&lt;chunksize=(2729077,), meta=np.ndarray&gt;
    longitude       (feature_id) float32 11MB dask.array&lt;chunksize=(2729077,), meta=np.ndarray&gt;
  * time            (time) datetime64[ns] 2MB 1993-01-01 ... 2018-12-31T23:00:00
Data variables:
    elevation       (time, feature_id) float32 2TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
    order           (time, feature_id) int32 2TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
    qBtmVertRunoff  (time, feature_id) float64 5TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
    qBucket         (time, feature_id) float64 5TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
    qSfcLatRunoff   (time, feature_id) float64 5TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
    q_lateral       (time, feature_id) float64 5TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
    streamflow      (time, feature_id) float64 5TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
    velocity        (time, feature_id) float64 5TB dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;
Attributes: (12/17)
    Conventions:                CF-1.6
    cdm_datatype:               Station
    code_version:               v5.1.0-alpha11
    dev:                        dev_ prefix indicates development/internal me...
    dev_NOAH_TIMESTEP:          3600
    dev_OVRTSWCRT:              1
    ...                         ...
    model_output_type:          channel_rt
    model_output_valid_time:    2018-12-28_00:00:00
    model_total_valid_times:    2208
    proj4:                      +proj=lcc +units=m +a=6370000.0 +b=6370000.0 ...
    station_dimension:          feature_id
    stream_order_output:        1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-92ba4f34-72c1-47fd-88e2-e468b2d52e1c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-92ba4f34-72c1-47fd-88e2-e468b2d52e1c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 227904</li><li><span class='xr-has-index'>feature_id</span>: 2729077</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f35a0b71-22ec-4f6c-a6cf-9ec6feb4de03' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f35a0b71-22ec-4f6c-a6cf-9ec6feb4de03' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>feature_id</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>101 179 ... 1180001803 1180001804</div><input id='attrs-c3d7742b-cdd6-448f-b385-20f2b46ca35c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c3d7742b-cdd6-448f-b385-20f2b46ca35c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80917b50-6e3a-4981-875f-bf0cc3fa18af' class='xr-var-data-in' type='checkbox'><label for='data-80917b50-6e3a-4981-875f-bf0cc3fa18af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cf_role :</span></dt><dd>timeseries_id</dd><dt><span>comment :</span></dt><dd>Gage Points Specified by User in Routelink file</dd><dt><span>long_name :</span></dt><dd>Reach ID</dd></dl></div><div class='xr-var-data'><pre>array([       101,        179,        181, ..., 1180001802, 1180001803,
       1180001804], shape=(2729077,), dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(2729077,), meta=np.ndarray&gt;</div><input id='attrs-8cb35948-a3ab-4090-b277-4e30d87dad0a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8cb35948-a3ab-4090-b277-4e30d87dad0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cde29bdf-1bc7-4152-9046-ade9db749e4a' class='xr-var-data-in' type='checkbox'><label for='data-cde29bdf-1bc7-4152-9046-ade9db749e4a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 10.41 MiB </td>
                        <td> 10.41 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2729077,) </td>
                        <td> (2729077,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(2729077,), meta=np.ndarray&gt;</div><input id='attrs-c7ac366b-536a-4560-a638-4c85716461ca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c7ac366b-536a-4560-a638-4c85716461ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5ac86a7b-79fb-47c6-942a-fa4761feae74' class='xr-var-data-in' type='checkbox'><label for='data-5ac86a7b-79fb-47c6-942a-fa4761feae74' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 10.41 MiB </td>
                        <td> 10.41 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2729077,) </td>
                        <td> (2729077,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-01-01 ... 2018-12-31T23:00:00</div><input id='attrs-8503e3e7-0daf-4af8-9e06-7484b36fe966' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8503e3e7-0daf-4af8-9e06-7484b36fe966' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-418092cd-28f4-459a-864e-da8a9cf00bbe' class='xr-var-data-in' type='checkbox'><label for='data-418092cd-28f4-459a-864e-da8a9cf00bbe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>valid output time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-01-01T00:00:00.000000000&#x27;, &#x27;1993-01-01T01:00:00.000000000&#x27;,
       &#x27;1993-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-12-31T21:00:00.000000000&#x27;,
       &#x27;2018-12-31T22:00:00.000000000&#x27;, &#x27;2018-12-31T23:00:00.000000000&#x27;],
      shape=(227904,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ef99cc6e-036d-4241-9889-7cd925725a71' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ef99cc6e-036d-4241-9889-7cd925725a71' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>elevation</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-831af02f-3a82-477f-94f9-824cfa0844aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-831af02f-3a82-477f-94f9-824cfa0844aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f77d66e0-be97-4267-a3d8-d7dd78c2d6fa' class='xr-var-data-in' type='checkbox'><label for='data-f77d66e0-be97-4267-a3d8-d7dd78c2d6fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature Elevation</dd><dt><span>standard_name :</span></dt><dd>Elevation</dd><dt><span>units :</span></dt><dd>meters</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.26 TiB </td>
                        <td> 76.90 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>order</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-d8d4dcb8-9607-4ce6-8f0d-7d0e084b3713' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d8d4dcb8-9607-4ce6-8f0d-7d0e084b3713' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3aeaa27b-30be-4bb5-8a33-1438421190a5' class='xr-var-data-in' type='checkbox'><label for='data-3aeaa27b-30be-4bb5-8a33-1438421190a5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Streamflow Order</dd><dt><span>standard_name :</span></dt><dd>order</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.26 TiB </td>
                        <td> 76.90 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qBtmVertRunoff</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-870ab546-9351-40d4-b15d-096a6f0b7297' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-870ab546-9351-40d4-b15d-096a6f0b7297' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c316ed0-5383-49a2-adc7-acf7c4a493d8' class='xr-var-data-in' type='checkbox'><label for='data-6c316ed0-5383-49a2-adc7-acf7c4a493d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Runoff from bottom of soil to bucket</dd><dt><span>units :</span></dt><dd>m3</dd><dt><span>valid_range :</span></dt><dd>[0, 499999968]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.53 TiB </td>
                        <td> 153.81 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qBucket</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-dfbb037e-3ebf-4050-95c7-5823ada7a944' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dfbb037e-3ebf-4050-95c7-5823ada7a944' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86bf62ff-fb1c-43c2-bfd8-2c083d547592' class='xr-var-data-in' type='checkbox'><label for='data-86bf62ff-fb1c-43c2-bfd8-2c083d547592' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Flux from gw bucket</dd><dt><span>units :</span></dt><dd>m3 s-1</dd><dt><span>valid_range :</span></dt><dd>[0, -2147483648]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.53 TiB </td>
                        <td> 153.81 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qSfcLatRunoff</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-db9529cc-6712-409f-af1d-903022cef33f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-db9529cc-6712-409f-af1d-903022cef33f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9cba44d7-b612-41ab-9d85-027ecc48bbb4' class='xr-var-data-in' type='checkbox'><label for='data-9cba44d7-b612-41ab-9d85-027ecc48bbb4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Runoff from terrain routing</dd><dt><span>units :</span></dt><dd>m3 s-1</dd><dt><span>valid_range :</span></dt><dd>[0, -2147483648]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.53 TiB </td>
                        <td> 153.81 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>q_lateral</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-32f2c892-ab7f-43a1-b05a-1c40fe596eae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-32f2c892-ab7f-43a1-b05a-1c40fe596eae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5b5b57c-4b53-4a81-aa2d-0619e667be58' class='xr-var-data-in' type='checkbox'><label for='data-e5b5b57c-4b53-4a81-aa2d-0619e667be58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Runoff into channel reach</dd><dt><span>units :</span></dt><dd>m3 s-1</dd><dt><span>valid_range :</span></dt><dd>[0, 5000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.53 TiB </td>
                        <td> 153.81 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>streamflow</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-b470d34d-5bb8-485a-a10a-60d67b365269' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b470d34d-5bb8-485a-a10a-60d67b365269' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-959317b2-2b39-4d8c-b658-8dfbc65307cb' class='xr-var-data-in' type='checkbox'><label for='data-959317b2-2b39-4d8c-b658-8dfbc65307cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Flow</dd><dt><span>units :</span></dt><dd>m3 s-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.53 TiB </td>
                        <td> 153.81 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 30000), meta=np.ndarray&gt;</div><input id='attrs-4e65f39d-a4bc-4d4b-b758-6ebbe46e4a67' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4e65f39d-a4bc-4d4b-b758-6ebbe46e4a67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad073b39-c0d2-4677-877c-b15ad7b2a0a4' class='xr-var-data-in' type='checkbox'><label for='data-ad073b39-c0d2-4677-877c-b15ad7b2a0a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Velocity</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.53 TiB </td>
                        <td> 153.81 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (227904, 2729077) </td>
                        <td> (672, 30000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 30940 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="19" x2="120" y2="19" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="29" x2="120" y2="29" />
  <line x1="0" y1="31" x2="120" y2="31" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="35" x2="120" y2="35" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="5" y1="0" x2="5" y2="37" />
  <line x1="11" y1="0" x2="11" y2="37" />
  <line x1="18" y1="0" x2="18" y2="37" />
  <line x1="25" y1="0" x2="25" y2="37" />
  <line x1="30" y1="0" x2="30" y2="37" />
  <line x1="36" y1="0" x2="36" y2="37" />
  <line x1="43" y1="0" x2="43" y2="37" />
  <line x1="50" y1="0" x2="50" y2="37" />
  <line x1="56" y1="0" x2="56" y2="37" />
  <line x1="61" y1="0" x2="61" y2="37" />
  <line x1="68" y1="0" x2="68" y2="37" />
  <line x1="75" y1="0" x2="75" y2="37" />
  <line x1="81" y1="0" x2="81" y2="37" />
  <line x1="88" y1="0" x2="88" y2="37" />
  <line x1="93" y1="0" x2="93" y2="37" />
  <line x1="100" y1="0" x2="100" y2="37" />
  <line x1="106" y1="0" x2="106" y2="37" />
  <line x1="113" y1="0" x2="113" y2="37" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.57579973674177 0.0,37.57579973674177" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.575800" font-size="1.0rem" font-weight="100" text-anchor="middle" >2729077</text>
  <text x="140.000000" y="18.787900" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,18.787900)">227904</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-52752bbc-dd7f-4f76-9362-3c093ce6d95d' class='xr-section-summary-in' type='checkbox'  ><label for='section-52752bbc-dd7f-4f76-9362-3c093ce6d95d' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>feature_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e543bc3d-108d-4597-a51f-28fb6a3f9dc5' class='xr-index-data-in' type='checkbox'/><label for='index-e543bc3d-108d-4597-a51f-28fb6a3f9dc5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([       101,        179,        181,        183,        185,        843,
              845,        847,        849,        851,
       ...
       1180001795, 1180001796, 1180001797, 1180001798, 1180001799, 1180001800,
       1180001801, 1180001802, 1180001803, 1180001804],
      dtype=&#x27;int32&#x27;, name=&#x27;feature_id&#x27;, length=2729077))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fe24f686-74a7-4a78-b25b-edb58626a34a' class='xr-index-data-in' type='checkbox'/><label for='index-fe24f686-74a7-4a78-b25b-edb58626a34a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1993-01-01 00:00:00&#x27;, &#x27;1993-01-01 01:00:00&#x27;,
               &#x27;1993-01-01 02:00:00&#x27;, &#x27;1993-01-01 03:00:00&#x27;,
               &#x27;1993-01-01 04:00:00&#x27;, &#x27;1993-01-01 05:00:00&#x27;,
               &#x27;1993-01-01 06:00:00&#x27;, &#x27;1993-01-01 07:00:00&#x27;,
               &#x27;1993-01-01 08:00:00&#x27;, &#x27;1993-01-01 09:00:00&#x27;,
               ...
               &#x27;2018-12-31 14:00:00&#x27;, &#x27;2018-12-31 15:00:00&#x27;,
               &#x27;2018-12-31 16:00:00&#x27;, &#x27;2018-12-31 17:00:00&#x27;,
               &#x27;2018-12-31 18:00:00&#x27;, &#x27;2018-12-31 19:00:00&#x27;,
               &#x27;2018-12-31 20:00:00&#x27;, &#x27;2018-12-31 21:00:00&#x27;,
               &#x27;2018-12-31 22:00:00&#x27;, &#x27;2018-12-31 23:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=227904, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6f765286-d6c6-4ce7-9493-2b6e6a050e0c' class='xr-section-summary-in' type='checkbox'  ><label for='section-6f765286-d6c6-4ce7-9493-2b6e6a050e0c' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>cdm_datatype :</span></dt><dd>Station</dd><dt><span>code_version :</span></dt><dd>v5.1.0-alpha11</dd><dt><span>dev :</span></dt><dd>dev_ prefix indicates development/internal meta data</dd><dt><span>dev_NOAH_TIMESTEP :</span></dt><dd>3600</dd><dt><span>dev_OVRTSWCRT :</span></dt><dd>1</dd><dt><span>dev_channelBucket_only :</span></dt><dd>0</dd><dt><span>dev_channel_only :</span></dt><dd>0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>model_configuration :</span></dt><dd>retrospective</dd><dt><span>model_initialization_time :</span></dt><dd>2018-10-01_00:00:00</dd><dt><span>model_output_type :</span></dt><dd>channel_rt</dd><dt><span>model_output_valid_time :</span></dt><dd>2018-12-28_00:00:00</dd><dt><span>model_total_valid_times :</span></dt><dd>2208</dd><dt><span>proj4 :</span></dt><dd>+proj=lcc +units=m +a=6370000.0 +b=6370000.0 +lat_1=30.0 +lat_2=60.0 +lat_0=40.0 +lon_0=-97.0 +x_0=0 +y_0=0 +k_0=1.0 +nadgrids=@</dd><dt><span>station_dimension :</span></dt><dd>feature_id</dd><dt><span>stream_order_output :</span></dt><dd>1</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="check-the-current-chunk-shape-and-size">
<h2>Check the Current Chunk Shape and Size<a class="headerlink" href="#check-the-current-chunk-shape-and-size" title="Link to this heading">#</a></h2>
<p>From the output, we can see there are two dimensions, <code class="docutils literal notranslate"><span class="pre">time</span></code> of length 227,904 and <code class="docutils literal notranslate"><span class="pre">feature_id</span></code> of length 2,729,077.
Both <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">feature_id</span></code> are coordinates, along with two extra coordinates of <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code> which are tied to the <code class="docutils literal notranslate"><span class="pre">feature_id</span></code>.
Inspecting these extra coordinates in detail, we notice they are “chunked”, but only to a single chunk of size 10.41 MiB.
This is good, as we will want them in a single chunk for writing, such that they are fully read in with each data variable chunk.
Finally, there are eight data variables, all having both of the dimensions, meaning they are 2D data.
Examining the variables in detail, they all have chunks of shape <code class="docutils literal notranslate"><span class="pre">{'time':</span> <span class="pre">672,</span> <span class="pre">'feature_id':</span> <span class="pre">30000}</span></code> and size of 153.81 MiB or 76.9 MiB (depending if the variable is 64- or 32-bit, respectively).
Additionally, we can see that each variable is a whopping 4.53 or 2.26 TiB in memory, which means the whole dataset is almost 32 TiB!</p>
<p>This is a bit more than we want to work with in our example.
So, let’s go ahead and select a subset of the data that is about 1 GiB in memory.
While this is not a larger-than-memory dataset anymore, it is still reasonably large and it will work well for this example without taking forever to get data and rechunk.
For the subset, let’s only look at water year 2018 (i.e., October 2017 to September 2018) for the variables <code class="docutils literal notranslate"><span class="pre">streamflow</span></code> and <code class="docutils literal notranslate"><span class="pre">velocity</span></code> for the first 15,000 <code class="docutils literal notranslate"><span class="pre">feature_id</span></code>s.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As we are not working on AWS, we have selected this subset to minimize the number of chunks that need to be downloaded from the S3 bucket.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[[</span><span class="s1">&#39;streamflow&#39;</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">]]</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">feature_id</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15000</span><span class="p">))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2017-10-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-09-30&#39;</span><span class="p">))</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:     (time: 8760, feature_id: 15000)
Coordinates:
  * feature_id  (feature_id) int32 60kB 101 179 181 183 ... 303420 303422 303424
    latitude    (feature_id) float32 60kB dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;
    longitude   (feature_id) float32 60kB dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;
  * time        (time) datetime64[ns] 70kB 2017-10-01 ... 2018-09-30T23:00:00
Data variables:
    streamflow  (time, feature_id) float64 1GB dask.array&lt;chunksize=(120, 15000), meta=np.ndarray&gt;
    velocity    (time, feature_id) float64 1GB dask.array&lt;chunksize=(120, 15000), meta=np.ndarray&gt;
Attributes: (12/17)
    Conventions:                CF-1.6
    cdm_datatype:               Station
    code_version:               v5.1.0-alpha11
    dev:                        dev_ prefix indicates development/internal me...
    dev_NOAH_TIMESTEP:          3600
    dev_OVRTSWCRT:              1
    ...                         ...
    model_output_type:          channel_rt
    model_output_valid_time:    2018-12-28_00:00:00
    model_total_valid_times:    2208
    proj4:                      +proj=lcc +units=m +a=6370000.0 +b=6370000.0 ...
    station_dimension:          feature_id
    stream_order_output:        1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-607ee1e1-7c81-49d1-85dc-5ea8f44e9bff' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-607ee1e1-7c81-49d1-85dc-5ea8f44e9bff' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 8760</li><li><span class='xr-has-index'>feature_id</span>: 15000</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ff4bff50-f9f1-4685-baad-4cc447edf4a8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ff4bff50-f9f1-4685-baad-4cc447edf4a8' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>feature_id</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>101 179 181 ... 303422 303424</div><input id='attrs-4f6e7238-978d-4333-a19a-10aac20dc143' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f6e7238-978d-4333-a19a-10aac20dc143' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dfca547a-1b32-4082-b1bb-416b786d0df5' class='xr-var-data-in' type='checkbox'><label for='data-dfca547a-1b32-4082-b1bb-416b786d0df5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cf_role :</span></dt><dd>timeseries_id</dd><dt><span>comment :</span></dt><dd>Gage Points Specified by User in Routelink file</dd><dt><span>long_name :</span></dt><dd>Reach ID</dd></dl></div><div class='xr-var-data'><pre>array([   101,    179,    181, ..., 303420, 303422, 303424],
      shape=(15000,), dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;</div><input id='attrs-7ca56e1c-5555-449f-a629-5eac4c9be774' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7ca56e1c-5555-449f-a629-5eac4c9be774' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1fa9e3b6-094b-4455-a3d1-424229f3ad55' class='xr-var-data-in' type='checkbox'><label for='data-1fa9e3b6-094b-4455-a3d1-424229f3ad55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 58.59 kiB </td>
                        <td> 58.59 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15000,) </td>
                        <td> (15000,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;</div><input id='attrs-2888f6fe-8baa-436c-8eb6-df121d115cdb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2888f6fe-8baa-436c-8eb6-df121d115cdb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-efd9ca1e-e3c6-4342-9e3b-f6eb88d17540' class='xr-var-data-in' type='checkbox'><label for='data-efd9ca1e-e3c6-4342-9e3b-f6eb88d17540' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 58.59 kiB </td>
                        <td> 58.59 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15000,) </td>
                        <td> (15000,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-10-01 ... 2018-09-30T23:00:00</div><input id='attrs-27ae849f-cead-41b7-8855-ca703884da78' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27ae849f-cead-41b7-8855-ca703884da78' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0f5f8c7-94a0-45da-b6b7-ac18f07958d2' class='xr-var-data-in' type='checkbox'><label for='data-e0f5f8c7-94a0-45da-b6b7-ac18f07958d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>valid output time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-10-01T00:00:00.000000000&#x27;, &#x27;2017-10-01T01:00:00.000000000&#x27;,
       &#x27;2017-10-01T02:00:00.000000000&#x27;, ..., &#x27;2018-09-30T21:00:00.000000000&#x27;,
       &#x27;2018-09-30T22:00:00.000000000&#x27;, &#x27;2018-09-30T23:00:00.000000000&#x27;],
      shape=(8760,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b38fe410-0fa9-431b-8adc-6406241b09b5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b38fe410-0fa9-431b-8adc-6406241b09b5' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>streamflow</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(120, 15000), meta=np.ndarray&gt;</div><input id='attrs-73be0e9d-3db4-4d83-8703-1168c5448031' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-73be0e9d-3db4-4d83-8703-1168c5448031' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0bcec36-1373-4f83-95f5-48a3e37ab506' class='xr-var-data-in' type='checkbox'><label for='data-a0bcec36-1373-4f83-95f5-48a3e37ab506' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Flow</dd><dt><span>units :</span></dt><dd>m3 s-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 76.90 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8760, 15000) </td>
                        <td> (672, 15000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 14 chunks in 4 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="0" x2="120" y2="0" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="38" x2="120" y2="38" />
  <line x1="0" y1="43" x2="120" y2="43" />
  <line x1="0" y1="49" x2="120" y2="49" />
  <line x1="0" y1="54" x2="120" y2="54" />
  <line x1="0" y1="60" x2="120" y2="60" />
  <line x1="0" y1="65" x2="120" y2="65" />
  <line x1="0" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="70" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,70.08 0.0,70.08" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="90.080000" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="35.040000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,35.040000)">8760</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(120, 15000), meta=np.ndarray&gt;</div><input id='attrs-b919a125-21f7-4b94-856d-ad56311782f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b919a125-21f7-4b94-856d-ad56311782f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e21e20e1-c67c-488d-b2ae-83619927a416' class='xr-var-data-in' type='checkbox'><label for='data-e21e20e1-c67c-488d-b2ae-83619927a416' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Velocity</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 76.90 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8760, 15000) </td>
                        <td> (672, 15000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 14 chunks in 4 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="0" x2="120" y2="0" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="27" x2="120" y2="27" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="38" x2="120" y2="38" />
  <line x1="0" y1="43" x2="120" y2="43" />
  <line x1="0" y1="49" x2="120" y2="49" />
  <line x1="0" y1="54" x2="120" y2="54" />
  <line x1="0" y1="60" x2="120" y2="60" />
  <line x1="0" y1="65" x2="120" y2="65" />
  <line x1="0" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="70" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,70.08 0.0,70.08" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="90.080000" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="35.040000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,35.040000)">8760</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b8130914-3ef7-47db-8103-fa3f49aa1d27' class='xr-section-summary-in' type='checkbox'  ><label for='section-b8130914-3ef7-47db-8103-fa3f49aa1d27' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>feature_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-80a946c2-ea96-4851-943f-fd80554de213' class='xr-index-data-in' type='checkbox'/><label for='index-80a946c2-ea96-4851-943f-fd80554de213' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   101,    179,    181,    183,    185,    843,    845,    847,    849,
          851,
       ...
       303404, 303408, 303410, 303412, 303414, 303416, 303418, 303420, 303422,
       303424],
      dtype=&#x27;int32&#x27;, name=&#x27;feature_id&#x27;, length=15000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-048271d8-0cbc-426d-9c21-e2f1964cd052' class='xr-index-data-in' type='checkbox'/><label for='index-048271d8-0cbc-426d-9c21-e2f1964cd052' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2017-10-01 00:00:00&#x27;, &#x27;2017-10-01 01:00:00&#x27;,
               &#x27;2017-10-01 02:00:00&#x27;, &#x27;2017-10-01 03:00:00&#x27;,
               &#x27;2017-10-01 04:00:00&#x27;, &#x27;2017-10-01 05:00:00&#x27;,
               &#x27;2017-10-01 06:00:00&#x27;, &#x27;2017-10-01 07:00:00&#x27;,
               &#x27;2017-10-01 08:00:00&#x27;, &#x27;2017-10-01 09:00:00&#x27;,
               ...
               &#x27;2018-09-30 14:00:00&#x27;, &#x27;2018-09-30 15:00:00&#x27;,
               &#x27;2018-09-30 16:00:00&#x27;, &#x27;2018-09-30 17:00:00&#x27;,
               &#x27;2018-09-30 18:00:00&#x27;, &#x27;2018-09-30 19:00:00&#x27;,
               &#x27;2018-09-30 20:00:00&#x27;, &#x27;2018-09-30 21:00:00&#x27;,
               &#x27;2018-09-30 22:00:00&#x27;, &#x27;2018-09-30 23:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=8760, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c3dcbc33-61f7-4ec2-96c5-1a923e344454' class='xr-section-summary-in' type='checkbox'  ><label for='section-c3dcbc33-61f7-4ec2-96c5-1a923e344454' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>cdm_datatype :</span></dt><dd>Station</dd><dt><span>code_version :</span></dt><dd>v5.1.0-alpha11</dd><dt><span>dev :</span></dt><dd>dev_ prefix indicates development/internal meta data</dd><dt><span>dev_NOAH_TIMESTEP :</span></dt><dd>3600</dd><dt><span>dev_OVRTSWCRT :</span></dt><dd>1</dd><dt><span>dev_channelBucket_only :</span></dt><dd>0</dd><dt><span>dev_channel_only :</span></dt><dd>0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>model_configuration :</span></dt><dd>retrospective</dd><dt><span>model_initialization_time :</span></dt><dd>2018-10-01_00:00:00</dd><dt><span>model_output_type :</span></dt><dd>channel_rt</dd><dt><span>model_output_valid_time :</span></dt><dd>2018-12-28_00:00:00</dd><dt><span>model_total_valid_times :</span></dt><dd>2208</dd><dt><span>proj4 :</span></dt><dd>+proj=lcc +units=m +a=6370000.0 +b=6370000.0 +lat_1=30.0 +lat_2=60.0 +lat_0=40.0 +lon_0=-97.0 +x_0=0 +y_0=0 +k_0=1.0 +nadgrids=@</dd><dt><span>station_dimension :</span></dt><dd>feature_id</dd><dt><span>stream_order_output :</span></dt><dd>1</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Now, our subset of data is only about 1 GiB per data variable and has a chunk shape of <code class="docutils literal notranslate"><span class="pre">{'time':</span> <span class="pre">672,</span> <span class="pre">'feature_id':</span> <span class="pre">15000}</span></code> with size of 76.9 MiB.
This is a good chunk size and between the optimal range of 10 to 200 MiB.
However, the chunk shape may not be an optimal choice for our analysis as it is chunked completely by <code class="docutils literal notranslate"><span class="pre">feature_id</span></code> (i.e., all feature IDs for a given time are read in a single chunk).</p>
</section>
<section id="choose-a-new-chunk-shape-and-size">
<h2>Choose a New Chunk Shape and Size<a class="headerlink" href="#choose-a-new-chunk-shape-and-size" title="Link to this heading">#</a></h2>
<p>To decide on a new chunk shape and size, we need to determine how we will use the data.
As we just discussed, an analysis which samples all locations for a single point in time would need to fetch only a single chunk, which is perfect for that analysis.
However, a time-series analysis (i.e. sampling all time-step values for a single <code class="docutils literal notranslate"><span class="pre">feature_id</span></code>) would require 13 chunks to be read for one feature.
This means many more chunks must be fetched for this read pattern.
Thinking of data usage, the preferred format for the streamflow data variable is likely time-series wise chunking as this variable is more often used as full time series at a single location.
The same goes for velocity.
However, for the purpose of this example, let’s assume that we don’t know how velocity will be used and give it a different chunking pattern, one where we balance the number of chunks between each dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nfeature</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">feature_id</span><span class="p">)</span>
<span class="n">ntime</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

<span class="n">streamflow_chunk_plan</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">ntime</span><span class="p">,</span> <span class="s1">&#39;feature_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">bytes_per_value</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">streamflow</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span>
<span class="n">total_bytes</span> <span class="o">=</span> <span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">bytes_per_value</span>
<span class="n">streamflow_MiB</span> <span class="o">=</span> <span class="n">total_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">10</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STREAMFLOW </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Shape of chunk: </span><span class="si">{</span><span class="n">streamflow_chunk_plan</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Partial &#39;time&#39; chunk remainder: </span><span class="si">{</span><span class="p">(</span><span class="n">ntime</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Partial &#39;feature_id&#39; chunk remainder: </span><span class="si">{</span><span class="p">(</span><span class="n">nfeature</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Chunk size: </span><span class="si">{</span><span class="n">streamflow_MiB</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> [MiB] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">chunks_per_dim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">velocity_chunk_plan</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">ntime</span> <span class="o">//</span> <span class="n">chunks_per_dim</span><span class="p">,</span> <span class="s1">&#39;feature_id&#39;</span><span class="p">:</span> <span class="n">nfeature</span> <span class="o">//</span> <span class="n">chunks_per_dim</span><span class="p">}</span>
<span class="n">bytes_per_value</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span>
<span class="n">total_bytes</span> <span class="o">=</span> <span class="n">velocity_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">velocity_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">bytes_per_value</span>
<span class="n">velocity_MiB</span> <span class="o">=</span> <span class="n">total_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">10</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VELOCITY </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Shape of chunk: </span><span class="si">{</span><span class="n">velocity_chunk_plan</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Partial &#39;time&#39; chunk remainder: </span><span class="si">{</span><span class="p">(</span><span class="n">ntime</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">velocity_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">velocity_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Partial &#39;feature_id&#39; chunk remainder: </span><span class="si">{</span><span class="p">(</span><span class="n">nfeature</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">velocity_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">velocity_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Chunk size: </span><span class="si">{</span><span class="n">velocity_MiB</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> [MiB]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STREAMFLOW 
Shape of chunk: {&#39;time&#39;: 8760, &#39;feature_id&#39;: 1} 
Partial &#39;time&#39; chunk remainder: 0.0 
Partial &#39;feature_id&#39; chunk remainder: 0.0 
Chunk size: 0.07 [MiB] 

VELOCITY 
Shape of chunk: {&#39;time&#39;: 2920, &#39;feature_id&#39;: 5000} 
Partial &#39;time&#39; chunk remainder: 0.0 
Partial &#39;feature_id&#39; chunk remainder: 0.0 
Chunk size: 111.39 [MiB]
</pre></div>
</div>
</div>
</div>
<p>The time-series streamflow chunking for a single feature ID has way too small of a chunk size.
If we increase the number of feature IDs per chunk by a factor of 1000, we should have the right size for that chunk
As for velocity, the split of the data into three chunks along both dimensions resulted in no partial chunks and a chunk size of 111 MiB.
This is within our optimal chunk size range.
So, let’s stick with the velocity chunks and recheck the streamflow chunking with 1000 features per time series chunk.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">streamflow_chunk_plan</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">ntime</span><span class="p">,</span> <span class="s1">&#39;feature_id&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">}</span>
<span class="n">bytes_per_value</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">streamflow</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span>
<span class="n">total_bytes</span> <span class="o">=</span> <span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">bytes_per_value</span>
<span class="n">streamflow_MiB</span> <span class="o">=</span> <span class="n">total_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">10</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STREAMFLOW </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Chunk of shape </span><span class="si">{</span><span class="n">streamflow_chunk_plan</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Partial &#39;time&#39; chunk remainder: </span><span class="si">{</span><span class="p">(</span><span class="n">ntime</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Partial &#39;feature_id&#39; chunk remainder: </span><span class="si">{</span><span class="p">(</span><span class="n">nfeature</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">streamflow_chunk_plan</span><span class="p">[</span><span class="s1">&#39;feature_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;Chunk size: </span><span class="si">{</span><span class="n">streamflow_MiB</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> [MiB] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STREAMFLOW 
Chunk of shape {&#39;time&#39;: 8760, &#39;feature_id&#39;: 1000} 
Partial &#39;time&#39; chunk remainder: 0.0 
Partial &#39;feature_id&#39; chunk remainder: 0.0 
Chunk size: 66.83 [MiB] 
</pre></div>
</div>
</div>
</div>
<p>Alright, no remainders and a reasonable chunk size.
Time to get to rechunking!</p>
</section>
<section id="rechunk-with-rechunker">
<h2>Rechunk with <a class="reference external" href="https://rechunker.readthedocs.io/en/latest/index.html">Rechunker</a><a class="headerlink" href="#rechunk-with-rechunker" title="Link to this heading">#</a></h2>
<p>This is a relatively trivial example, due to the smaller size of the subset of the dataset.
As the whole subset can fit into memory easily, chunking in general is largely unnecesary in terms of optimizing I/O (however, parallelism is still a consideration).
But it is worth doing, as the concepts will apply if we take this to the full dataset.</p>
<p>First thing we need to determine is a chunk plan to describe the chunk layout we want.
We already created a basic version of this above that describes the chunk shapes of streamflow and velocity.
We just need to place it into a more cohesive list along with chunk shapes for the coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunk_plan</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;streamflow&#39;</span><span class="p">:</span> <span class="n">streamflow_chunk_plan</span><span class="p">,</span>
    <span class="s1">&#39;velocity&#39;</span><span class="p">:</span> <span class="n">velocity_chunk_plan</span><span class="p">,</span>
     <span class="c1"># We don&#39;t want any of the coordinates chunked</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">nfeature</span><span class="p">,),</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">nfeature</span><span class="p">,),</span>    
    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">ntime</span><span class="p">,),</span>
    <span class="s1">&#39;feature_id&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">nfeature</span><span class="p">,)</span>
<span class="p">}</span>
<span class="n">chunk_plan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;streamflow&#39;: {&#39;time&#39;: 8760, &#39;feature_id&#39;: 1000},
 &#39;velocity&#39;: {&#39;time&#39;: 2920, &#39;feature_id&#39;: 5000},
 &#39;latitude&#39;: (15000,),
 &#39;longitude&#39;: (15000,),
 &#39;time&#39;: (8760,),
 &#39;feature_id&#39;: (15000,)}
</pre></div>
</div>
</div>
</div>
<p>With this plan, we can ask <a class="reference external" href="https://rechunker.readthedocs.io/en/latest/index.html">Rechunker</a> to re-write the data using the prescribed chunking pattern.
Rechunker will read the data and rechunk it using an intermediate Zarr store for efficiency.
This will produce a new Zarr store with the chunk shapes we specified in <code class="docutils literal notranslate"><span class="pre">chunk_plan</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;rechunked_nwm.zarr&quot;</span>
<span class="n">temp_store</span> <span class="o">=</span> <span class="s2">&quot;/tmp/scratch.zarr&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span>
        <span class="n">target_chunks</span><span class="o">=</span><span class="n">chunk_plan</span><span class="p">,</span>
        <span class="n">max_mem</span><span class="o">=</span><span class="s2">&quot;2GB&quot;</span><span class="p">,</span>
        <span class="n">target_store</span><span class="o">=</span><span class="n">outfile</span> <span class="p">,</span>
        <span class="n">temp_store</span><span class="o">=</span><span class="n">temp_store</span>
    <span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Zarr requires uniform chunk sizes except for final chunk. Variable named &#39;streamflow&#39; has incompatible dask chunks: ((120, 672, 672, 672, 672, 672, 672, 672, 672, 672, 672, 672, 672, 576), (15000,)). Consider rechunking using `chunk()`.
</pre></div>
</div>
</div>
</div>
<p>Oh, that is not what we wanted!
We seem to have gotten an error indicating overlap in chunks between the read and write.
Looking at the error, it is saying that the first <code class="docutils literal notranslate"><span class="pre">time</span></code> chunk we are reading is a partial chunk and not a full chunk.
So, when Rechunker tries to read the data and then write the first rechunk, it is having to read two chunks to write to the one chunk.
This is a one-to-many write, which can corrupt our file when done in parallel with dask.
Thank goodness Rechunker caught this for us!
Reading the recommended fix, it seems the only way to go about this is to call <code class="docutils literal notranslate"><span class="pre">chunk()</span></code> and reset the chunking on the original data.
In other words, after we select the subset from the dataset, we need to realign the chunks such that the first chunk is not a partial chunk.
This is simple enough to do.
So much so, we can just do it when passing the dataset subset to Rechunker.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">rechunker.rechunk</span></code> does not overwrite any data.
If it sees that <code class="docutils literal notranslate"><span class="pre">rechunked_nwm.zarr</span></code> or <code class="docutils literal notranslate"><span class="pre">/tmp/scratch.zarr</span></code> already exist, it will raise an exception.
Be sure that these locations do not exist before calling Rechunker.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We must delete the started rechunked zarr stores</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_store</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="mi">672</span><span class="p">,</span> <span class="s1">&#39;feature_id&#39;</span><span class="p">:</span> <span class="mi">15000</span><span class="p">}),</span>
    <span class="n">target_chunks</span><span class="o">=</span><span class="n">chunk_plan</span><span class="p">,</span>
    <span class="n">max_mem</span><span class="o">=</span><span class="s2">&quot;2GB&quot;</span><span class="p">,</span>
    <span class="n">target_store</span><span class="o">=</span><span class="n">outfile</span> <span class="p">,</span>
    <span class="n">temp_store</span><span class="o">=</span><span class="n">temp_store</span>
<span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><h2>Rechunked</h2>
        <details>
          <summary><b>Source</b></summary>
          <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:     (time: 8760, feature_id: 15000)
Coordinates:
  * feature_id  (feature_id) int32 60kB 101 179 181 183 ... 303420 303422 303424
    latitude    (feature_id) float32 60kB dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;
    longitude   (feature_id) float32 60kB dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;
  * time        (time) datetime64[ns] 70kB 2017-10-01 ... 2018-09-30T23:00:00
Data variables:
    streamflow  (time, feature_id) float64 1GB dask.array&lt;chunksize=(672, 15000), meta=np.ndarray&gt;
    velocity    (time, feature_id) float64 1GB dask.array&lt;chunksize=(672, 15000), meta=np.ndarray&gt;
Attributes: (12/17)
    Conventions:                CF-1.6
    cdm_datatype:               Station
    code_version:               v5.1.0-alpha11
    dev:                        dev_ prefix indicates development/internal me...
    dev_NOAH_TIMESTEP:          3600
    dev_OVRTSWCRT:              1
    ...                         ...
    model_output_type:          channel_rt
    model_output_valid_time:    2018-12-28_00:00:00
    model_total_valid_times:    2208
    proj4:                      +proj=lcc +units=m +a=6370000.0 +b=6370000.0 ...
    station_dimension:          feature_id
    stream_order_output:        1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-72438372-1eac-4e0e-9c72-28dd8d613977' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-72438372-1eac-4e0e-9c72-28dd8d613977' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 8760</li><li><span class='xr-has-index'>feature_id</span>: 15000</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-719e28d8-cd1f-4159-9b34-639fb332a486' class='xr-section-summary-in' type='checkbox'  checked><label for='section-719e28d8-cd1f-4159-9b34-639fb332a486' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>feature_id</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>101 179 181 ... 303422 303424</div><input id='attrs-5b043795-fd18-41f5-a893-da482cb70ab7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5b043795-fd18-41f5-a893-da482cb70ab7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d7e0e4a9-2a98-4200-b24e-47f30f8cc351' class='xr-var-data-in' type='checkbox'><label for='data-d7e0e4a9-2a98-4200-b24e-47f30f8cc351' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cf_role :</span></dt><dd>timeseries_id</dd><dt><span>comment :</span></dt><dd>Gage Points Specified by User in Routelink file</dd><dt><span>long_name :</span></dt><dd>Reach ID</dd></dl></div><div class='xr-var-data'><pre>array([   101,    179,    181, ..., 303420, 303422, 303424],
      shape=(15000,), dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;</div><input id='attrs-736b3387-583a-4172-a20e-98c35a24165a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-736b3387-583a-4172-a20e-98c35a24165a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c8a0797-8afd-485d-a27c-d428147b0ed9' class='xr-var-data-in' type='checkbox'><label for='data-3c8a0797-8afd-485d-a27c-d428147b0ed9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 58.59 kiB </td>
                        <td> 58.59 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15000,) </td>
                        <td> (15000,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;</div><input id='attrs-170ead70-9fc4-4c20-9c55-11b7d4a88c74' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-170ead70-9fc4-4c20-9c55-11b7d4a88c74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4dbfe54d-1d2c-4bda-881c-e14ec1c02323' class='xr-var-data-in' type='checkbox'><label for='data-4dbfe54d-1d2c-4bda-881c-e14ec1c02323' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 58.59 kiB </td>
                        <td> 58.59 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15000,) </td>
                        <td> (15000,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-10-01 ... 2018-09-30T23:00:00</div><input id='attrs-60c5b770-c4b3-45a4-b1a5-724ea9e0f84b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-60c5b770-c4b3-45a4-b1a5-724ea9e0f84b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50a5c391-248a-4eb2-ac37-067e1dad691d' class='xr-var-data-in' type='checkbox'><label for='data-50a5c391-248a-4eb2-ac37-067e1dad691d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>valid output time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-10-01T00:00:00.000000000&#x27;, &#x27;2017-10-01T01:00:00.000000000&#x27;,
       &#x27;2017-10-01T02:00:00.000000000&#x27;, ..., &#x27;2018-09-30T21:00:00.000000000&#x27;,
       &#x27;2018-09-30T22:00:00.000000000&#x27;, &#x27;2018-09-30T23:00:00.000000000&#x27;],
      shape=(8760,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d4d7789a-aa60-4ccb-ad99-565b979ea9bd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d4d7789a-aa60-4ccb-ad99-565b979ea9bd' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>streamflow</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 15000), meta=np.ndarray&gt;</div><input id='attrs-2953abc5-47d1-45ad-9f5a-d55261f5175f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2953abc5-47d1-45ad-9f5a-d55261f5175f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd453122-984b-433d-aa6c-9484ee4d2b37' class='xr-var-data-in' type='checkbox'><label for='data-bd453122-984b-433d-aa6c-9484ee4d2b37' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Flow</dd><dt><span>units :</span></dt><dd>m3 s-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 76.90 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8760, 15000) </td>
                        <td> (672, 15000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 14 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="26" x2="120" y2="26" />
  <line x1="0" y1="32" x2="120" y2="32" />
  <line x1="0" y1="37" x2="120" y2="37" />
  <line x1="0" y1="43" x2="120" y2="43" />
  <line x1="0" y1="48" x2="120" y2="48" />
  <line x1="0" y1="53" x2="120" y2="53" />
  <line x1="0" y1="59" x2="120" y2="59" />
  <line x1="0" y1="64" x2="120" y2="64" />
  <line x1="0" y1="69" x2="120" y2="69" />
  <line x1="0" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="70" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,70.08 0.0,70.08" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="90.080000" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="35.040000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,35.040000)">8760</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(672, 15000), meta=np.ndarray&gt;</div><input id='attrs-561236a5-a49b-4260-b0e4-d4e1d5383e31' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-561236a5-a49b-4260-b0e4-d4e1d5383e31' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14cd3320-2b29-4576-b7cc-5791bd8eef98' class='xr-var-data-in' type='checkbox'><label for='data-14cd3320-2b29-4576-b7cc-5791bd8eef98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Velocity</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 76.90 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8760, 15000) </td>
                        <td> (672, 15000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 14 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="26" x2="120" y2="26" />
  <line x1="0" y1="32" x2="120" y2="32" />
  <line x1="0" y1="37" x2="120" y2="37" />
  <line x1="0" y1="43" x2="120" y2="43" />
  <line x1="0" y1="48" x2="120" y2="48" />
  <line x1="0" y1="53" x2="120" y2="53" />
  <line x1="0" y1="59" x2="120" y2="59" />
  <line x1="0" y1="64" x2="120" y2="64" />
  <line x1="0" y1="69" x2="120" y2="69" />
  <line x1="0" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="70" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,70.08 0.0,70.08" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="90.080000" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="35.040000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,35.040000)">8760</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-e502db04-842c-4a33-92e6-bc4f5850aeaa' class='xr-section-summary-in' type='checkbox'  ><label for='section-e502db04-842c-4a33-92e6-bc4f5850aeaa' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>feature_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d5ce88a7-9059-4477-bc16-7e46bc4837bf' class='xr-index-data-in' type='checkbox'/><label for='index-d5ce88a7-9059-4477-bc16-7e46bc4837bf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   101,    179,    181,    183,    185,    843,    845,    847,    849,
          851,
       ...
       303404, 303408, 303410, 303412, 303414, 303416, 303418, 303420, 303422,
       303424],
      dtype=&#x27;int32&#x27;, name=&#x27;feature_id&#x27;, length=15000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-90dc74c0-f615-4df9-8f65-8b684ed3fbe5' class='xr-index-data-in' type='checkbox'/><label for='index-90dc74c0-f615-4df9-8f65-8b684ed3fbe5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2017-10-01 00:00:00&#x27;, &#x27;2017-10-01 01:00:00&#x27;,
               &#x27;2017-10-01 02:00:00&#x27;, &#x27;2017-10-01 03:00:00&#x27;,
               &#x27;2017-10-01 04:00:00&#x27;, &#x27;2017-10-01 05:00:00&#x27;,
               &#x27;2017-10-01 06:00:00&#x27;, &#x27;2017-10-01 07:00:00&#x27;,
               &#x27;2017-10-01 08:00:00&#x27;, &#x27;2017-10-01 09:00:00&#x27;,
               ...
               &#x27;2018-09-30 14:00:00&#x27;, &#x27;2018-09-30 15:00:00&#x27;,
               &#x27;2018-09-30 16:00:00&#x27;, &#x27;2018-09-30 17:00:00&#x27;,
               &#x27;2018-09-30 18:00:00&#x27;, &#x27;2018-09-30 19:00:00&#x27;,
               &#x27;2018-09-30 20:00:00&#x27;, &#x27;2018-09-30 21:00:00&#x27;,
               &#x27;2018-09-30 22:00:00&#x27;, &#x27;2018-09-30 23:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=8760, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f9744c80-e426-4dac-9e8f-ae683558fa54' class='xr-section-summary-in' type='checkbox'  ><label for='section-f9744c80-e426-4dac-9e8f-ae683558fa54' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>cdm_datatype :</span></dt><dd>Station</dd><dt><span>code_version :</span></dt><dd>v5.1.0-alpha11</dd><dt><span>dev :</span></dt><dd>dev_ prefix indicates development/internal meta data</dd><dt><span>dev_NOAH_TIMESTEP :</span></dt><dd>3600</dd><dt><span>dev_OVRTSWCRT :</span></dt><dd>1</dd><dt><span>dev_channelBucket_only :</span></dt><dd>0</dd><dt><span>dev_channel_only :</span></dt><dd>0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>model_configuration :</span></dt><dd>retrospective</dd><dt><span>model_initialization_time :</span></dt><dd>2018-10-01_00:00:00</dd><dt><span>model_output_type :</span></dt><dd>channel_rt</dd><dt><span>model_output_valid_time :</span></dt><dd>2018-12-28_00:00:00</dd><dt><span>model_total_valid_times :</span></dt><dd>2208</dd><dt><span>proj4 :</span></dt><dd>+proj=lcc +units=m +a=6370000.0 +b=6370000.0 +lat_1=30.0 +lat_2=60.0 +lat_0=40.0 +lon_0=-97.0 +x_0=0 +y_0=0 +k_0=1.0 +nadgrids=@</dd><dt><span>station_dimension :</span></dt><dd>feature_id</dd><dt><span>stream_order_output :</span></dt><dd>1</dd></dl></div></li></ul></div></div>
        </details>
        <details>
<summary><b>Intermediate</b></summary>
None
</details>

        <details>
          <summary><b>Target</b></summary>
          None
        </details>
</div></div>
</div>
<p>Alright, that worked with no problems!
Now, we must specifically direct rechunk to calculate.
To do this, we can call <code class="docutils literal notranslate"><span class="pre">execute()</span></code> on our <code class="docutils literal notranslate"><span class="pre">result</span></code> <code class="docutils literal notranslate"><span class="pre">Rechunked</span></code> object.
Without the call to <code class="docutils literal notranslate"><span class="pre">execute()</span></code>, the Zarr dataset will be empty, and <code class="docutils literal notranslate"><span class="pre">result</span></code> will only hold a ‘task graph’ outlining the calculation steps.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Rechunker also writes a minimalist data group, meaning that variable metadata is not consolidated.
This is not a required step, but it will really spead up future workflows when the data is read back in using xarray.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">consolidate_metadata</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="confirm-the-creation-of-the-zarr-store-by-rechunker">
<h2>Confirm the Creation of the Zarr Store by Rechunker<a class="headerlink" href="#confirm-the-creation-of-the-zarr-store-by-rechunker" title="Link to this heading">#</a></h2>
<p>Let’s read in the resulting re-chunked dataset to confirm it turned out how we intended.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_rechunked</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
<span class="n">ds_rechunked</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:     (feature_id: 15000, time: 8760)
Coordinates:
  * feature_id  (feature_id) int32 60kB 101 179 181 183 ... 303420 303422 303424
    latitude    (feature_id) float32 60kB dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;
    longitude   (feature_id) float32 60kB dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;
  * time        (time) datetime64[ns] 70kB 2017-10-01 ... 2018-09-30T23:00:00
Data variables:
    streamflow  (time, feature_id) float64 1GB dask.array&lt;chunksize=(8760, 1000), meta=np.ndarray&gt;
    velocity    (time, feature_id) float64 1GB dask.array&lt;chunksize=(2920, 5000), meta=np.ndarray&gt;
Attributes: (12/17)
    Conventions:                CF-1.6
    cdm_datatype:               Station
    code_version:               v5.1.0-alpha11
    dev:                        dev_ prefix indicates development/internal me...
    dev_NOAH_TIMESTEP:          3600
    dev_OVRTSWCRT:              1
    ...                         ...
    model_output_type:          channel_rt
    model_output_valid_time:    2018-12-28_00:00:00
    model_total_valid_times:    2208
    proj4:                      +proj=lcc +units=m +a=6370000.0 +b=6370000.0 ...
    station_dimension:          feature_id
    stream_order_output:        1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-80762f05-4657-4b45-9d22-05e3b697f504' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-80762f05-4657-4b45-9d22-05e3b697f504' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>feature_id</span>: 15000</li><li><span class='xr-has-index'>time</span>: 8760</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f5c8b045-7683-4e44-85e9-ae03d8c77259' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f5c8b045-7683-4e44-85e9-ae03d8c77259' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>feature_id</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>101 179 181 ... 303422 303424</div><input id='attrs-901814ee-772d-4f0f-9e19-3dcfcd2084b7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-901814ee-772d-4f0f-9e19-3dcfcd2084b7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a067d4c2-32c5-4f19-9788-c6d8c4befb81' class='xr-var-data-in' type='checkbox'><label for='data-a067d4c2-32c5-4f19-9788-c6d8c4befb81' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cf_role :</span></dt><dd>timeseries_id</dd><dt><span>comment :</span></dt><dd>Gage Points Specified by User in Routelink file</dd><dt><span>long_name :</span></dt><dd>Reach ID</dd></dl></div><div class='xr-var-data'><pre>array([   101,    179,    181, ..., 303420, 303422, 303424],
      shape=(15000,), dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;</div><input id='attrs-b25272b3-7f0f-44e8-9f3d-c715c782fbf4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b25272b3-7f0f-44e8-9f3d-c715c782fbf4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a2dcda57-43bc-4823-b105-6c5e36a71059' class='xr-var-data-in' type='checkbox'><label for='data-a2dcda57-43bc-4823-b105-6c5e36a71059' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 58.59 kiB </td>
                        <td> 58.59 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15000,) </td>
                        <td> (15000,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(feature_id)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15000,), meta=np.ndarray&gt;</div><input id='attrs-d4e2537f-c386-4ebe-bdab-b82815e8f147' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d4e2537f-c386-4ebe-bdab-b82815e8f147' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fc9851a-8d43-4fa2-9acd-6cc4968709e0' class='xr-var-data-in' type='checkbox'><label for='data-3fc9851a-8d43-4fa2-9acd-6cc4968709e0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Feature longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 58.59 kiB </td>
                        <td> 58.59 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15000,) </td>
                        <td> (15000,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-10-01 ... 2018-09-30T23:00:00</div><input id='attrs-0bad0f68-e1ca-4d9d-992f-4f03af36268f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0bad0f68-e1ca-4d9d-992f-4f03af36268f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8451eb61-474f-477b-84b3-6338cfadfc2c' class='xr-var-data-in' type='checkbox'><label for='data-8451eb61-474f-477b-84b3-6338cfadfc2c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>valid output time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-10-01T00:00:00.000000000&#x27;, &#x27;2017-10-01T01:00:00.000000000&#x27;,
       &#x27;2017-10-01T02:00:00.000000000&#x27;, ..., &#x27;2018-09-30T21:00:00.000000000&#x27;,
       &#x27;2018-09-30T22:00:00.000000000&#x27;, &#x27;2018-09-30T23:00:00.000000000&#x27;],
      shape=(8760,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e6f46060-68ea-428d-b3b2-3d90ed0a503a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e6f46060-68ea-428d-b3b2-3d90ed0a503a' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>streamflow</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(8760, 1000), meta=np.ndarray&gt;</div><input id='attrs-156f9de5-680c-4fdc-9f9c-18b7c1da8ce6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-156f9de5-680c-4fdc-9f9c-18b7c1da8ce6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ede67ccd-d2bf-4e29-b381-42b8c72a515e' class='xr-var-data-in' type='checkbox'><label for='data-ede67ccd-d2bf-4e29-b381-42b8c72a515e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Flow</dd><dt><span>units :</span></dt><dd>m3 s-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 66.83 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8760, 15000) </td>
                        <td> (8760, 1000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 15 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="70" style="stroke-width:2" />
  <line x1="8" y1="0" x2="8" y2="70" />
  <line x1="16" y1="0" x2="16" y2="70" />
  <line x1="24" y1="0" x2="24" y2="70" />
  <line x1="32" y1="0" x2="32" y2="70" />
  <line x1="40" y1="0" x2="40" y2="70" />
  <line x1="48" y1="0" x2="48" y2="70" />
  <line x1="56" y1="0" x2="56" y2="70" />
  <line x1="64" y1="0" x2="64" y2="70" />
  <line x1="72" y1="0" x2="72" y2="70" />
  <line x1="80" y1="0" x2="80" y2="70" />
  <line x1="88" y1="0" x2="88" y2="70" />
  <line x1="96" y1="0" x2="96" y2="70" />
  <line x1="104" y1="0" x2="104" y2="70" />
  <line x1="112" y1="0" x2="112" y2="70" />
  <line x1="120" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,70.08 0.0,70.08" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="90.080000" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="35.040000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,35.040000)">8760</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(time, feature_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(2920, 5000), meta=np.ndarray&gt;</div><input id='attrs-5abb1982-2fcc-4edc-aecc-b241eeab6f41' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5abb1982-2fcc-4edc-aecc-b241eeab6f41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-01bad4b5-e7b9-4331-8e54-5304b649c96a' class='xr-var-data-in' type='checkbox'><label for='data-01bad4b5-e7b9-4331-8e54-5304b649c96a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>River Velocity</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>valid_range :</span></dt><dd>[0, 50000000]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.98 GiB </td>
                        <td> 111.39 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8760, 15000) </td>
                        <td> (2920, 5000) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 9 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="46" x2="120" y2="46" />
  <line x1="0" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="70" style="stroke-width:2" />
  <line x1="40" y1="0" x2="40" y2="70" />
  <line x1="80" y1="0" x2="80" y2="70" />
  <line x1="120" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,70.08 0.0,70.08" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="90.080000" font-size="1.0rem" font-weight="100" text-anchor="middle" >15000</text>
  <text x="140.000000" y="35.040000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,35.040000)">8760</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-ebdd0e10-896e-48fe-b33a-d05adb549e03' class='xr-section-summary-in' type='checkbox'  ><label for='section-ebdd0e10-896e-48fe-b33a-d05adb549e03' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>feature_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-667b3725-a77f-4ea9-bbf4-bfa018d9bb9a' class='xr-index-data-in' type='checkbox'/><label for='index-667b3725-a77f-4ea9-bbf4-bfa018d9bb9a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   101,    179,    181,    183,    185,    843,    845,    847,    849,
          851,
       ...
       303404, 303408, 303410, 303412, 303414, 303416, 303418, 303420, 303422,
       303424],
      dtype=&#x27;int32&#x27;, name=&#x27;feature_id&#x27;, length=15000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7a74c733-786c-4d66-8083-2f67dc26978e' class='xr-index-data-in' type='checkbox'/><label for='index-7a74c733-786c-4d66-8083-2f67dc26978e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2017-10-01 00:00:00&#x27;, &#x27;2017-10-01 01:00:00&#x27;,
               &#x27;2017-10-01 02:00:00&#x27;, &#x27;2017-10-01 03:00:00&#x27;,
               &#x27;2017-10-01 04:00:00&#x27;, &#x27;2017-10-01 05:00:00&#x27;,
               &#x27;2017-10-01 06:00:00&#x27;, &#x27;2017-10-01 07:00:00&#x27;,
               &#x27;2017-10-01 08:00:00&#x27;, &#x27;2017-10-01 09:00:00&#x27;,
               ...
               &#x27;2018-09-30 14:00:00&#x27;, &#x27;2018-09-30 15:00:00&#x27;,
               &#x27;2018-09-30 16:00:00&#x27;, &#x27;2018-09-30 17:00:00&#x27;,
               &#x27;2018-09-30 18:00:00&#x27;, &#x27;2018-09-30 19:00:00&#x27;,
               &#x27;2018-09-30 20:00:00&#x27;, &#x27;2018-09-30 21:00:00&#x27;,
               &#x27;2018-09-30 22:00:00&#x27;, &#x27;2018-09-30 23:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=8760, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ea197369-6575-4614-9e75-93fa06702223' class='xr-section-summary-in' type='checkbox'  ><label for='section-ea197369-6575-4614-9e75-93fa06702223' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>cdm_datatype :</span></dt><dd>Station</dd><dt><span>code_version :</span></dt><dd>v5.1.0-alpha11</dd><dt><span>dev :</span></dt><dd>dev_ prefix indicates development/internal meta data</dd><dt><span>dev_NOAH_TIMESTEP :</span></dt><dd>3600</dd><dt><span>dev_OVRTSWCRT :</span></dt><dd>1</dd><dt><span>dev_channelBucket_only :</span></dt><dd>0</dd><dt><span>dev_channel_only :</span></dt><dd>0</dd><dt><span>featureType :</span></dt><dd>timeSeries</dd><dt><span>model_configuration :</span></dt><dd>retrospective</dd><dt><span>model_initialization_time :</span></dt><dd>2018-10-01_00:00:00</dd><dt><span>model_output_type :</span></dt><dd>channel_rt</dd><dt><span>model_output_valid_time :</span></dt><dd>2018-12-28_00:00:00</dd><dt><span>model_total_valid_times :</span></dt><dd>2208</dd><dt><span>proj4 :</span></dt><dd>+proj=lcc +units=m +a=6370000.0 +b=6370000.0 +lat_1=30.0 +lat_2=60.0 +lat_0=40.0 +lon_0=-97.0 +x_0=0 +y_0=0 +k_0=1.0 +nadgrids=@</dd><dt><span>station_dimension :</span></dt><dd>feature_id</dd><dt><span>stream_order_output :</span></dt><dd>1</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Great, our chunk shapes are exactly what we specified!
Let’s do one final check that will compare our original subset of the dataset with our new rechunked dataset, that way we can confirm nothing unexpected happened during rechunking.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For our small example dataset this is easy as the data will fit into memory.
More efficient and better ways should be used for larger datasets.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ds</span> <span class="o">-</span> <span class="n">ds_rechunked</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/conda/hytest/738ff346-1752093942-203-pangeo/lib/python3.11/site-packages/dask/array/core.py:4998: PerformanceWarning: Increasing number of chunks by factor of 14
  result = blockwise(
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 16B
Dimensions:     ()
Data variables:
    streamflow  float64 8B 0.0
    velocity    float64 8B 0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-246ff5d8-104f-43cb-9644-463edb83c59d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-246ff5d8-104f-43cb-9644-463edb83c59d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9d8338eb-c2fa-4407-9a91-7f164fbcc34c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9d8338eb-c2fa-4407-9a91-7f164fbcc34c' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-8a487ebd-dd2b-4713-9796-2ffd6acbbab3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8a487ebd-dd2b-4713-9796-2ffd6acbbab3' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>streamflow</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-e8965f4b-d2d4-4ebb-89b3-fdad9d847e16' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e8965f4b-d2d4-4ebb-89b3-fdad9d847e16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4fe8611b-426e-4ac3-801b-5ef200cf13b3' class='xr-var-data-in' type='checkbox'><label for='data-4fe8611b-426e-4ac3-801b-5ef200cf13b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-cc9523c2-9fea-49cf-8980-0541b195af19' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cc9523c2-9fea-49cf-8980-0541b195af19' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9fbad830-f402-45b3-b496-d39fb34a8967' class='xr-var-data-in' type='checkbox'><label for='data-9fbad830-f402-45b3-b496-d39fb34a8967' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a10fe649-8cfa-4661-9e62-b9cdc7698db4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a10fe649-8cfa-4661-9e62-b9cdc7698db4' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-749c2ad7-3360-4e1b-9f18-42a6a63d83d9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-749c2ad7-3360-4e1b-9f18-42a6a63d83d9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Perfect!
The maximum absolute difference between each both the <code class="docutils literal notranslate"><span class="pre">streamflow</span></code> and <code class="docutils literal notranslate"><span class="pre">velocity</span></code> variables is 0.
In other words, they are exactly the same, and Rechunker worked as expect.</p>
<p>Now that you know how to rechunk a Zarr store using Rechunker, you should know all of the basics there are in terms of chunking.
You are now ready to explore more <a class="reference internal" href="../201/index.html"><span class="std std-doc">advanced chunking topics in chunking</span></a> if you are interested!</p>
</section>
<section id="clean-up">
<h2>Clean Up<a class="headerlink" href="#clean-up" title="Link to this heading">#</a></h2>
<p>As we don’t want to keep this rechunked Zarr on our local machine, let’s go ahead and delete it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_store</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./dataset_processing/tutorials/chunking/101"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="WriteChunkedFiles.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Writing Chunked Files</p>
      </div>
    </a>
    <a class="right-next"
       href="../201/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Advanced Topics in Chunking</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-a-zarr-store">Read in a Zarr Store</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-current-chunk-shape-and-size">Check the Current Chunk Shape and Size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-a-new-chunk-shape-and-size">Choose a New Chunk Shape and Size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rechunk-with-rechunker">Rechunk with Rechunker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confirm-the-creation-of-the-zarr-store-by-rechunker">Confirm the Creation of the Zarr Store by Rechunker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-up">Clean Up</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>