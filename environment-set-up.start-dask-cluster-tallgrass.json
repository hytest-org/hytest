{"version":3,"kind":"Notebook","sha256":"5037a732e7365a620aec23cdd5ae5aa063ac6501fa75d159e08845591a01220f","slug":"environment-set-up.start-dask-cluster-tallgrass","location":"/environment_set_up/Start_Dask_Cluster_Tallgrass.ipynb","dependencies":[],"frontmatter":{"title":"Hovenweep/Tallgrass HPC Dask Cluster","content_includes_title":false,"github":"https://github.com/hytest-org/hytest","copyright":"2023","numbering":{"title":{"offset":2}},"source_url":"https://github.com/hytest-org/hytest/blob/main/environment_set_up/Start_Dask_Cluster_Tallgrass.ipynb","edit_url":"https://github.com/hytest-org/hytest/edit/main/environment_set_up/Start_Dask_Cluster_Tallgrass.ipynb","exports":[{"format":"ipynb","filename":"Start_Dask_Cluster_Tallgrass.ipynb","url":"/hytest//build/Start_Dask_Cluster_T-26ea4f0c0d49117a72c2ad62766c5273.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport logging\n\nfrom dask.distributed import Client\nfrom dask_jobqueue import SLURMCluster   \n\ntry:\n    project = os.environ['SLURM_JOB_ACCOUNT']\nexcept KeyError:\n    logging.error(\"SLURM_JOB_ACCOUNT is not set in the active environment. Are you on the login node? You should not be running this there.\")\n    raise\n\ncluster = SLURMCluster(\n    account='hytest', \n    processes=1, \n    cores=1, \n    memory='8GB', \n    interface='ib0',\n    walltime='01:00:00',      \n    shared_temp_directory='/home/asnyder/tmp'\n)\ncluster.adapt(minimum=2, maximum=30)\n\nclient = Client(cluster)\n\nif os.environ['SLURM_CLUSTER_NAME']=='hovenweep':\n    ood_pre = 'hw'\nelif os.environ['SLURM_CLUSTER_NAME']=='tallgrass':\n    ood_pre = 'tg'\n\nood_dashboard_link = f\"https://{ood_pre}-ood.cr.usgs.gov/node/{os.environ['JUPYTER_SERVER_NODE']}/{os.environ['JUPYTER_SERVER_PORT']}/proxy/{client.dashboard_link.split(':')[2]}\"\nprint(f'Dask Dashboard for OnDemand is available at: {ood_dashboard_link}')","key":"Am9UefUAzy"},{"type":"outputs","id":"8xXJ07jRXhT4iCswkL5Up","children":[],"key":"za4zSQP1Zm"}],"key":"R10J6OhWxt"}],"key":"puAWrN5NoU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Denali HPC Dask Cluster","url":"/environment-set-up/start-dask-cluster-denali","group":"Environment Set-Up"},"next":{"title":"Local Desktop Dask Cluster","url":"/environment-set-up/start-dask-cluster-desktop","group":"Environment Set-Up"}}},"domain":"http://localhost:3005"}