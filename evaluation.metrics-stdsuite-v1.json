{"version":3,"kind":"Notebook","sha256":"2738de69c8227c7222120ca2f7da95ac78bcc852ba3719d3f57d66f23e4fd1e5","slug":"evaluation.metrics-stdsuite-v1","location":"/evaluation/Metrics_StdSuite_v1.ipynb","dependencies":[],"frontmatter":{"title":"Standard Suite (v1) Metrics","content_includes_title":false,"github":"https://github.com/hytest-org/hytest","copyright":"2023","numbering":{"title":{"offset":2}},"source_url":"https://github.com/hytest-org/hytest/blob/main/evaluation/Metrics_StdSuite_v1.ipynb","edit_url":"https://github.com/hytest-org/hytest/edit/main/evaluation/Metrics_StdSuite_v1.ipynb","exports":[{"format":"ipynb","filename":"Metrics_StdSuite_v1.ipynb","url":"/hytest//build/Metrics_StdSuite_v1-8a06772944bfd97be94efd211108ed27.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"These are custom-defined Python functions to calculate metrics using timeseries data. These are mainly intended to be used with streamflow timeseries data, though may be applicable elsewhere.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EKE25wYcY3"}],"key":"VzaMnASSh0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"See ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"q2tmtv5X0A"},{"type":"cite","url":"https://doi.org/10.5194/hess-27-1809-2023","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Towler et al 2023","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NoFlXOKcaQ"}],"kind":"narrative","label":"Towler2023Benchmarking","identifier":"https://doi.org/10.5194/hess-27-1809-2023","enumerator":"1","key":"jsef33WFJY"},{"type":"text","value":" for a published application.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DX8FFDTEZe"}],"key":"HV5j7LlOBP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Towler, E., Foks, S.S., Dugger, A.L., Dickinson, J.E., Essaid, H.I., Gochis, D., Viger, R.J., and Zhang, Y. (2023). Benchmarking High-Resolution, Hydrologic Performance of Long-Term Retrospectives in the United States, Hydrology and Earth System Sciences.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"T796Poold7"}],"key":"qIGpsLM9yd"}],"key":"WqTFxyLOBw"}],"key":"HIz1uhf4Vx"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"These functions have been adapted from the originals in ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DxoeNjasn4"},{"type":"link","url":"https://github.com/USGS-python/hytest-evaluation-workflows/blob/main/gallery/streamflow/02_nwm_benchmark_analysis.ipynb","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"gallery​/streamflow​/02​_nwm​_benchmark​_analysis​.ipynb","key":"W6oJ3XuQQE"}],"urlSource":"https://github.com/USGS-python/hytest-evaluation-workflows/blob/main/gallery/streamflow/02_nwm_benchmark_analysis.ipynb","data":{"kind":"file","org":"USGS-python","repo":"hytest-evaluation-workflows","reference":"main","file":"gallery/streamflow/02_nwm_benchmark_analysis.ipynb","raw":"https://raw.githubusercontent.com/USGS-python/hytest-evaluation-workflows/main/gallery/streamflow/02_nwm_benchmark_analysis.ipynb"},"internal":false,"protocol":"github","key":"Une00TfdNu"}],"key":"DwX4faBxMz"}],"key":"iTegDbXAFt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Metrics:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yHVdugwrxR"}],"identifier":"the-metrics","label":"The Metrics:","html_id":"the-metrics","implicit":true,"key":"JitiF1zr4r"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This suite of metrics describes the Standard Suite v1 benchmarking metrics:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vCZbk61q1l"}],"key":"u1rAjYKke1"},{"type":"table","position":{"start":{"line":4,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Metric","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DNpbl4MUf8"}],"key":"T8nowhSjk7"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Used on these variables","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kYIxvs1zYy"}],"key":"B0V6krcTWo"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Reference","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"A7ChBg01av"}],"key":"XGRmyoYeTy"}],"key":"H6v0yQ3oue"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Nash-Sutcliffe efficiency (NSE)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eRXBN84fRj"}],"key":"fJk357PDS3"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dWKt0usT1r"}],"key":"pTaYoWUzvV"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Nash, J. E., & Sutcliffe, J. V. (1970). River flow forecasting through conceptual models part I—A discussion of principles. Journal of hydrology, 10(3), 282-290. ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MCl74K47OK"},{"type":"link","url":"https://www.sciencedirect.com/science/article/pii/0022169470902556?via%3Dihub","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"https://​www​.sciencedirect​.com​/science​/article​/pii​/0022169470902556​?via​%3Dihub","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"f3NLheO45f"}],"urlSource":"https://www.sciencedirect.com/science/article/pii/0022169470902556?via%3Dihub","key":"PuliJDs87x"}],"key":"Z35Zdfl94E"}],"key":"jQssaQ9er2"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Kling-Gupta efficiency (KGE)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eNjRfq1D2Q"}],"key":"Z5Nh8RisE5"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VkfqvdanFr"}],"key":"VMR8lGqzyj"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Gupta, H. V., Kling, H., Yilmaz, K. K., & Martinez, G. F. (2009).  Decomposition of the mean squared error and NSE performance criteria: Implications for improving hydrological modelling. Journal of hydrology, 377(1-2), 80-91. ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JU00AzSzUF"},{"type":"link","url":"https://www.sciencedirect.com/science/article/pii/S0022169409004843","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"https://​www​.sciencedirect​.com​/science​/article​/pii​/S0022169409004843","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lXyir8pefT"}],"urlSource":"https://www.sciencedirect.com/science/article/pii/S0022169409004843","key":"WFs3vU0agj"}],"key":"iNWsQhY8nS"}],"key":"th3G6Yx1pw"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"logNSE","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kCOROGSrVq"}],"key":"DBJt5sA63I"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vF8X2jXLWW"}],"key":"pOrtlvxgiP"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Oudin, L., Andréassian, V., Mathevet, T., Perrin, C., & Michel, C. (2006). Dynamic averaging of rainfall‐runoff model simulations from complementary model parameterizations. Water Resources  Research, 42(7).","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cAdcDu0UMr"}],"key":"TkEMpl8xja"}],"key":"q351Xyxo5R"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"percent bias","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EDsD5Da1qR"}],"key":"JMQZtn6cpU"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hdOTMpAVU1"}],"key":"lQG81GT4j9"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"A measure of the mean tendency of simulated values to be greater or less than associated observed values, units of percent","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CCZ0NJlFxP"}],"key":"Z1v60yPdwG"}],"key":"M63We9nb2t"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"ratio of standard deviation","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zkJeHFQ62q"}],"key":"nHxXlN5aZv"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"WsRRvMzlag"}],"key":"zFLjj1cJc4"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"standard deviation of simulated values divided by the standard deviation of observed values","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IwIU6ZePv3"}],"key":"XAC9qlbelj"}],"key":"isu8N6oGPL"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Pearson Correlation","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XwIgfK73uf"}],"key":"cnwNoxPYky"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"BcuQfA4GPm"}],"key":"qDySvgdGrH"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"K. Pearson (1896, 1900, 1920)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QZKeOu0UQI"}],"key":"aW1yCT5lTT"}],"key":"l0mYF4oNjE"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Spearman Correlation","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ScpCbrda4B"}],"key":"JAQ8O9fdjn"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Z5F8nLMkxq"}],"key":"uxuNcfUp2t"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Charles Spearman (1904, 1910)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"yiNPmySmiw"}],"key":"ecVXOSBAs1"}],"key":"LUMJGV8Jpq"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"percent bias in midsegment slope of the flow-duration curve (FDC) between Q20-Q70","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"FeJtf28BaE"}],"key":"xGO1KiVTT5"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"streamflow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"n1LYvOH9wi"}],"key":"ppExMUwUEo"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Yilmaz, K. K., Gupta, H. V., & Wagener, T. (2008). A process‐based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model. Water Resources Research, 44(9).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uUTCuTXERe"}],"key":"yjxrnJwGD2"}],"key":"udLoseVVa6"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"percent bias in FDC low-segment volume (Q0-Q30)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ciTmaxP6uj"}],"key":"rlCGKdWZfn"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"streamflow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JKgKtBcUuK"}],"key":"dlmmAaPgCA"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Yilmaz, K. K., Gupta, H. V., & Wagener, T. (2008). A process‐based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model. Water Resources Research, 44(9).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"eYm9sGCRH8"}],"key":"LtlkczFGe1"}],"key":"GXOzTKIgJd"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"percent bias in FDC high-segment volume (Q98-Q100)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zkD2kgtNKg"}],"key":"T9ab58JXGB"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"streamflow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ehJWaeoG7S"}],"key":"ujsdIzqYVm"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Yilmaz, K. K., Gupta, H. V., & Wagener, T. (2008). A process‐based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model. Water Resources Research, 44(9).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"v0hDER42Eo"}],"key":"Qt9qPzcYKl"}],"key":"lyNZki3G0M"}],"key":"ctQ0XxnBS8"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"This notebook will briefly describe each of the above metrics, and show some results using sample data.\nThe specific code to implement each metric is included.  This notebook can be sourced into analysis notebooks\nto get access to these functions natively.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"eKrhuTnykU"}],"key":"KDuTddS3ye"}],"key":"rgzDpCBAye"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport logging","key":"ZiDKdfs0Pj"},{"type":"outputs","id":"_T5SDmRLMDsMNn24RSZpa","children":[],"key":"ee1B1jbBK5"}],"key":"lrsvU62zoL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Metric Definitions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nyhVyRtQmL"}],"identifier":"metric-definitions","label":"Metric Definitions","html_id":"metric-definitions","implicit":true,"key":"ZNrgCuJcGS"}],"key":"gA0rk7bpgs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Mean Square Error (MSE)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RKvA9cQmcL"}],"identifier":"mean-square-error-mse","label":"Mean Square Error (MSE)","html_id":"mean-square-error-mse","implicit":true,"key":"Em0L2ANP3g"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Many subsequent functions rely on MSE.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yMOI4LYlis"}],"key":"C88faWNTQR"}],"key":"o91O49Gx9x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def MSE(obs, sim) -> float:\n    \"\"\"\n    Mean Square Error --   Compute MSE over all paired values obs (x) and sim (x_hat)\n        \n    Returns\n    -------\n    float\n        Mean square error\n    \"\"\"\n    err = obs - sim\n    return np.mean(err**2)","key":"h78R3IiH7Q"},{"type":"outputs","id":"bYSXgYymwNQ56m3dMLxWJ","children":[],"key":"tK1ME05xXb"}],"key":"hxuJ7933nN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nash-Sutcliffe efficiency (NSE)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BEdShZqFxV"}],"identifier":"nash-sutcliffe-efficiency-nse","label":"Nash-Sutcliffe efficiency (NSE)","html_id":"nash-sutcliffe-efficiency-nse","implicit":true,"key":"Rw5P3oNMD8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Nash, J. E., & Sutcliffe, J. V. (1970). River flow forecasting through conceptual models part I—A discussion of principles. Journal of hydrology, 10(3), 282-290.\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DsNHpagpd5"},{"type":"link","url":"https://www.sciencedirect.com/science/article/pii/0022169470902556?via%3Dihub","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.sciencedirect​.com​/science​/article​/pii​/0022169470902556​?via​%3Dihub","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ruwsQQgAEm"}],"urlSource":"https://www.sciencedirect.com/science/article/pii/0022169470902556?via%3Dihub","key":"R5hpmeIUen"}],"key":"ibJ2JtHyBf"}],"key":"F5x0fNNUA2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def NSE(obs, sim) -> float:\n    \"\"\"\n    Nash-Sutcliffe efficiency (NSE)\n\n    Returns:\n        float: calculated NSE\n    \"\"\"\n    return 1 - (MSE(obs, sim) / np.var(obs, ddof=0))\n    # See NOTE re:  ddof ","key":"sTSU91P08F"},{"type":"outputs","id":"bXYFvbsiDkzrl45p982C2","children":[],"key":"pAie5HfY4E"}],"key":"fHCnhm6599"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Special note on NSE & variance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Txz8u85AQk"}],"key":"rRYPWBEfTG"},{"type":"text","value":" — A component within the calculation of NSE is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XKQITn63Cd"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"variance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e3T2ErxqQI"}],"key":"Z1VM9iM4Qx"},{"type":"text","value":" computed over the\nobserved values. Different python libraries calculated this in different ways, so some of the details matter\nwhen calculating.  In particular, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NMEyex8cuY"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C2jOkYSe52"},{"type":"text","value":" assumes that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nugNSg98zX"},{"type":"inlineCode","value":"ddof","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DUYNnIbRWa"},{"type":"text","value":" (Delta Degrees of Freedom)\nis ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kRPi0JdHTq"},{"type":"link","url":"https://numpy.org/doc/stable/reference/generated/numpy.var.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"zero","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gJBGGfBVoy"}],"urlSource":"https://numpy.org/doc/stable/reference/generated/numpy.var.html","key":"GNQdRsK14T"},{"type":"text","value":", while  ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jr6KUoujkr"},{"type":"inlineCode","value":"pandas","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"na7gb7Hht9"},{"type":"text","value":"\nassumes a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F1JasjMztY"},{"type":"inlineCode","value":"ddof","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fBxMOgD6T1"},{"type":"text","value":" of\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J3P6jT8M7J"},{"type":"link","url":"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.var.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"one","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c5te5GdAGj"}],"urlSource":"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.var.html","key":"MyGaPr1zoV"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"alJ53SahYg"},{"type":"link","url":"https://en.wikipedia.org/wiki/Bessel%27s_correction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Bessel’s Correction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qPR1ZZdMhy"}],"urlSource":"https://en.wikipedia.org/wiki/Bessel%27s_correction","data":{"page":"Bessel%27s_correction","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"zzIXM9ggVD"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sTFqR5auLO"}],"key":"R0x54sgOiw"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Without explicit instructions, these two common libraries will return different results for the ‘","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"w4A6z4yZL0"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"same","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rcx6lZr4lF"}],"key":"doc3Qsh71G"},{"type":"text","value":"’ calculation,\nso it is important not to inter-mix the libraries. If you should decide to build your own functions involving\nvariance, it will matter how you calculate that value:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"YyUb0XISoQ"}],"key":"nFN0gjO54R"},{"type":"code","lang":"python","value":"df['obs'].var()  # using pandas","position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"key":"eS5hR2M2UZ"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"will yield a ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"rSqpyl5ssQ"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"different","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"UnjInevRpv"}],"key":"h9T4K4wtQU"},{"type":"text","value":" result than","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"I7IbFgxAUp"}],"key":"ayb8Nv2dFO"},{"type":"code","lang":"python","value":"np.var(df['obs']) # using numpy","position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"key":"x9kY7VGjzz"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"The key (in either case) is to ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"YxezVuuooT"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"explicitly","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"LXxGfIgjCT"}],"key":"nA7jp0oA1d"},{"type":"text","value":" define the ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"EQUfIcuylo"},{"type":"inlineCode","value":"ddof","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"yGVXavwRCs"},{"type":"text","value":":","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ngH2TnzVoY"}],"key":"O3EXE5P9rj"},{"type":"code","lang":"python","value":"df['obs'].var(ddof=0)\n# or\nnp.var(df['obs'], ddof=0)","position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"key":"CvSroZajQa"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"The original codespec for this benchmark series used numpy, with its default DDOF of 0 and explicit definition of DDOF to ensure compatibility with similar metrics.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"M7AfOWhP8o"}],"key":"XihdcEm025"}],"key":"OBX4AHSXWX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ratio of Standard Deviations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xHlqwn2ZRT"}],"identifier":"ratio-of-standard-deviations","label":"Ratio of Standard Deviations","html_id":"ratio-of-standard-deviations","implicit":true,"key":"RQS8QIn3v2"}],"key":"XXT4o7BPor"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def rSD(obs, sim) -> float:\n    \"\"\"\n    ratio of standard deviation  -- standard deviation of simulated/modeled\n    values divided by the standard deviation of observed values\n\n    Returns:\n        float: calculated ratio\n    \"\"\"\n    try:\n        return np.std(sim) / np.std(obs)\n    except ZeroDivisionError:\n        logging.warning(\"std dev of observed is zero; ratio undefined\")\n        return None","key":"l7ThexFsgF"},{"type":"outputs","id":"VqMtQom3HiAB1Nibhj_VB","children":[],"key":"vQYzCNcI0P"}],"key":"qECf4biyPR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Correlation Coefficients: Pearson and Spearman","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RZUOJKvYsY"}],"identifier":"correlation-coefficients-pearson-and-spearman","label":"Correlation Coefficients: Pearson and Spearman","html_id":"correlation-coefficients-pearson-and-spearman","implicit":true,"key":"bUw7xAzbRl"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"These standard measures are available in reliable and fast libraries from ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IkDs4PVSqK"},{"type":"link","url":"https://scipy.org/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"SciPy","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ESefC4yAx2"}],"urlSource":"https://scipy.org/","key":"W1GqW1jtbZ"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fGmveOBIat"}],"key":"G5eXhcpKyO"}],"key":"ZIKWEyKAly"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.stats import pearsonr, spearmanr\n\ndef pearson_r(obs, sim) -> float:\n    \"\"\"\n    Pearson Correlation -- Pearson's R, calculated using the scipi library method\n\n    Returns\n    -------\n    float\n        Pearson's R\n    \"\"\"\n    return pearsonr(obs, sim)[0]\n\ndef spearman_r(obs, sim) -> float:\n    \"\"\"\n    Spearman Correlation == Spearman's R, calcuated using the scipy method\n\n    Returns\n    -------\n    float\n        Calculated R                                 |\n    \"\"\"\n    return spearmanr(obs, sim)[0]\n","key":"G8I59hrBhQ"},{"type":"outputs","id":"pqSQrf3LrxuDXSZpX84ef","children":[],"key":"Ech8jgvQaK"}],"key":"whFAHAUfZ0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Kling-Gupta efficiency (KGE)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F1s11KWMXO"}],"identifier":"kling-gupta-efficiency-kge","label":"Kling-Gupta efficiency (KGE)","html_id":"kling-gupta-efficiency-kge","implicit":true,"key":"jSvK9PsInx"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Gupta, H. V., Kling, H., Yilmaz, K. K., & Martinez, G. F. (2009).  Decomposition of the mean squared error and NSE performance criteria: Implications for improving hydrological modelling. Journal of hydrology, 377(1-2), 80-91. ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nn0ToxBINv"},{"type":"link","url":"https://www.sciencedirect.com/science/article/pii/S0022169409004843","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​www​.sciencedirect​.com​/science​/article​/pii​/S0022169409004843","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iyu1ZBYGdE"}],"urlSource":"https://www.sciencedirect.com/science/article/pii/S0022169409004843","key":"TOFhzTQFvg"}],"key":"si6yDaIpjO"}],"key":"dnviTTrWMO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def KGE(obs, sim) -> float:\n    \"\"\"\n    Kling-Gupta efficiency (KGE)\n\n    Returns:\n        float: Calculated KGE\n    \"\"\"\n    r = pearsonr(obs, sim)[0]\n    alpha = rSD(obs, sim)\n    beta = np.sum(sim) / np.sum(obs)\n    return 1 - np.sqrt((r-1)**2 + (alpha-1)**2 + (beta-1)**2)","key":"nJslLrYqD5"},{"type":"outputs","id":"n3zciI5aN6PDSnIqyGUUX","children":[],"key":"j31mYaR2eG"}],"key":"pjog2l6MQ9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"logNSE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rRaaF03PBB"}],"identifier":"lognse","label":"logNSE","html_id":"lognse","implicit":true,"key":"XPKFhi8EqY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Oudin, L., Andréassian, V., Mathevet, T., Perrin, C., & Michel, C. (2006). Dynamic averaging of rainfall‐runoff model simulations from complementary model parameterizations. Water Resources  Research, 42(7).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gc44HzYUOd"}],"key":"rT80xhbsZD"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This is a NSE metric, run against log-transformed data.  Because we can’t have log work on zero values, the data must be sanitized to ensure only positive values are passed to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ReW33Jhc0U"},{"type":"inlineCode","value":"np.log()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dxadNl0Je0"},{"type":"text","value":". Of the various ways to treat zeros, we use a clipping function to ‘promote’ values below a small threshold up to that threshold value.  By default, any value below 0.01 is treated as 0.01 for purposes of the log transform.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lu89fR8DwG"}],"key":"QcJ5K4tXg3"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"This data sanitization is handled differently within other libraries, notably ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Erv2xaDxem"},{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ShoL8FkEox"},{"type":"text","value":".  That package uses a slightly more complex strategy to ensure that ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XANGsJZyQB"},{"type":"inlineCode","value":"log()","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VQCE1FzapK"},{"type":"text","value":" gets clean data to work on. The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pn394a83Ok"},{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qrF1zBWy92"},{"type":"text","value":" developer\nreferences ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CrVqsN3I61"},{"type":"cite","url":"https://doi.org/10.1016/j.jhydrol.2011.11.055","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Pushpalatha et al. (2012)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OjBKWmYi9m"}],"kind":"narrative","label":"Pushpalatha_2012","identifier":"https://doi.org/10.1016/j.jhydrol.2011.11.055","enumerator":"2","key":"g6wGduOqqg"},{"type":"text","value":" regarding their strategy.  The details of that method are beyond scope here -- just know that if you compare results with ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"A2sWil17qj"},{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RNrOsztmcY"},{"type":"text","value":", this metric may yield very slightly different results.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"phU3fV0QJQ"}],"key":"ViS37lF1wM"}],"key":"QmHBoxomru"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def logXform(a, **kwargs):\n    ### we are allowing for the possible future addition of other methods to treat zero values. 'clip' is the default. \n    if 'clip' in kwargs:\n        assert kwargs['clip'] > 0\n        A = a.clip(kwargs['clip'])\n    return np.log(A)\n\ndef logNSE(obs, sim) -> float:\n    \"\"\"\n    logNSE - computes NSE using the log of data (rather than data)\n\n        float: Calculated NSE of log(data)\n    \"\"\"\n    return NSE(logXform(obs, clip=0.01), logXform(sim, clip=0.1))\n","key":"POxU4JoMJX"},{"type":"outputs","id":"rYpm0QBVcFeJ0KaLRHy3K","children":[],"key":"klwTYcAkZf"}],"key":"J1a3LNSqVg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Percent Bias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t63LG4gEjs"}],"identifier":"percent-bias","label":"Percent Bias","html_id":"percent-bias","implicit":true,"key":"penALeGdxU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A measure of the mean tendency of simulated values to be greater or less than associated observed values, units of percent","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qBDqbQVvOg"}],"key":"kZon4Ipquz"}],"key":"p3eVOlmtTx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def pbias(obs, sim) -> float:\n    \"\"\"\n    percent bias -- a measure of the mean tendency of simulated values to be\n    greater than or less than associated observed values.\n\n    Returns:\n        float: calculated percent bias / units = percent (i.e. 90 rather than 0.90)\n    \"\"\"\n    return 100 * np.sum(sim - obs) / np.sum(obs)","key":"rzCoJJgbW6"},{"type":"outputs","id":"SCk0o7_wK23RMT41XUHFj","children":[],"key":"jhALztibVt"}],"key":"I2xDNo9hPS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Special Note on pbias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RVJdRAbv9R"}],"key":"OttLMH5nSE"},{"type":"text","value":" -- as relates to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WTUxSvkodv"},{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"McWaSCLItn"},{"type":"text","value":" and other libraries.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"chSHkpFjST"}],"key":"Zy7oSd3Lhx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The result we compute here mimics the behavior of the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Z29U7bOfl4"},{"type":"inlineCode","value":"hydroGOF","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WOEULCVVhN"},{"type":"text","value":" R package, and is the result of the code provided in\nthe ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"N2APfTnyir"},{"type":"link","url":"https://github.com/USGS-python/hytest-evaluation-workflows/blob/main/gallery/streamflow/02_nwm_benchmark_analysis.ipynb","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"model notebook","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LZ8uo10VWH"}],"urlSource":"https://github.com/USGS-python/hytest-evaluation-workflows/blob/main/gallery/streamflow/02_nwm_benchmark_analysis.ipynb","data":{"kind":"file","org":"USGS-python","repo":"hytest-evaluation-workflows","reference":"main","file":"gallery/streamflow/02_nwm_benchmark_analysis.ipynb","raw":"https://raw.githubusercontent.com/USGS-python/hytest-evaluation-workflows/main/gallery/streamflow/02_nwm_benchmark_analysis.ipynb"},"internal":false,"protocol":"github","key":"ErBKyl94mO"},{"type":"text","value":"\nmentioned above.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YhuX795fDo"}],"key":"GetInrIf55"}],"key":"TXO2v1P6Kf"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This differs from the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XekoiJIXMd"},{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wdGCI8vfgP"},{"type":"text","value":" Python package in an important way.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kqYJeLfQ1d"}],"key":"shnnROILTL"}],"key":"TdH1L4TSiV"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"inlineCode","value":"hydroGOF","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"FgqOyMQAbK"},{"type":"text","value":" (and this benchmark) returns:  ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yE7RM2056J"},{"type":"break","key":"VNDIm7agOn"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ffeE1NMg0m"},{"type":"inlineMath","value":"100 × \\frac{\\displaystyle\\sum_{i=1}^{n}(\\hat{x}_{i} - x_{i})}{\\displaystyle\\sum_{i=1}^{n}x_{i}}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mo>×</mo><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mi>i</mi></msub></mstyle></mfrac></mrow><annotation encoding=\"application/x-tex\">100 × \\frac{\\displaystyle\\sum_{i=1}^{n}(\\hat{x}_{i} - x_{i})}{\\displaystyle\\sum_{i=1}^{n}x_{i}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:5.9781em;vertical-align:-2.7391em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2391em;\"><span style=\"top:-2.19em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop op-limits sizing reset-size3 size6\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size3 size6\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.8814em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-5.2391em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop op-limits sizing reset-size3 size6\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen sizing reset-size3 size6\">(</span><span class=\"mord sizing reset-size3 size6\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size3 size6\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord sizing reset-size3 size6\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose sizing reset-size3 size6\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7391em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"tSPBkQFh8K"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TacWmQRw6x"},{"type":"break","key":"qkpVk2SVPH"},{"type":"text","value":"where ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qHtq4PDRA9"},{"type":"inlineMath","value":"x","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ZsnhvkrWB7"},{"type":"text","value":" is ‘observed’ and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"re8qGKGqVZ"},{"type":"inlineMath","value":"\\hat{x}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"THMjutkoKY"},{"type":"text","value":" is ‘modeled’","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"e6M9tf39r8"}],"key":"E8iRBDZELA"}],"key":"wl3340WA4N"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VIw7LGyPR8"},{"type":"text","value":" on the other hand, returns:  ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xtnRN9fv2C"},{"type":"break","key":"zflhoTMy7n"},{"type":"text","value":" ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xoxJNgiPTV"},{"type":"inlineMath","value":"100 × \\frac{\\displaystyle\\sum_{i=1}^{n}(x_{i} - \\hat{x}_{i})}{\\displaystyle\\sum_{i=1}^{n}x_{i}}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mo>×</mo><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mi>i</mi></msub></mstyle></mfrac></mrow><annotation encoding=\"application/x-tex\">100 × \\frac{\\displaystyle\\sum_{i=1}^{n}(x_{i} - \\hat{x}_{i})}{\\displaystyle\\sum_{i=1}^{n}x_{i}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:5.9781em;vertical-align:-2.7391em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2391em;\"><span style=\"top:-2.19em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop op-limits sizing reset-size3 size6\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size3 size6\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.8814em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-5.2391em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop op-limits sizing reset-size3 size6\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen sizing reset-size3 size6\">(</span><span class=\"mord sizing reset-size3 size6\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size3 size6\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord sizing reset-size3 size6\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose sizing reset-size3 size6\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7391em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"vg8QhHmDDK"},{"type":"break","key":"kk5Vymk9CO"},{"type":"text","value":"Note\ntht the numerator has switched the ordering of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"faN2slI2ZP"},{"type":"inlineMath","value":"x","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"A98sl1uMJT"},{"type":"text","value":" and ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ALUNizygxV"},{"type":"inlineMath","value":"\\hat{x}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"RKiPPJkdZx"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"eKJzTATZyi"}],"key":"bnvaxzpXkw"}],"key":"hM9HhNGXjd"}],"key":"MyOGknPZ3w"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The end result is that these two libraries return values of different sign. ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FWu8LNVGWX"},{"type":"inlineCode","value":"hydroGOF","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"E4MdMjIaan"},{"type":"text","value":" returns a positive value if the ‘modeled’ tends to be higher than ‘observed’, while ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vpMVtPj8f8"},{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"scRAAlxXv8"},{"type":"text","value":" will return a negative number in this case. The absolute values of these calulations are the same.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"m65UrfPE1t"}],"key":"yiA2kc9wbE"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The developer for ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"TG0tL3xV14"},{"type":"inlineCode","value":"hydroeval","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dK9d7GTSZh"},{"type":"text","value":" points to ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Ev3fhSIDfI"},{"type":"link","url":"https://elibrary.asabe.org/abstract.asp?aid=23153","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"this document","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KVF2n8aQ6n"}],"urlSource":"https://elibrary.asabe.org/abstract.asp?aid=23153","key":"kx58iunx7r"},{"type":"text","value":" as the source of the math used in that package.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cblrqW12BR"}],"key":"yFy3irbA3r"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"This code library uses the same ordering as ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LAuCgsNBlq"},{"type":"inlineCode","value":"hydroGOF","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"HPo2PbO1dG"},{"type":"text","value":", which is describe in EQN A1 of Yilmaz et al. (2008)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"dDOCRZWpKi"}],"key":"zEvo2xzuXQ"}],"key":"Q7Umsdz31j"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"FDC - Flow Duration Curves","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tRvN1f2RLL"}],"identifier":"fdc-flow-duration-curves","label":"FDC - Flow Duration Curves","html_id":"fdc-flow-duration-curves","implicit":true,"key":"CdhJT0fytZ"},{"type":"table","position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Metric","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SM139G29S6"}],"key":"aOSYcyBqgl"},{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Reference","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kIsrO8bhR0"}],"key":"tdSS7nKjEA"}],"key":"d6X3AQoYVS"},{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"percent bias in midsegment slope of the flow-duration curve (FDC) between Q20-Q70","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"SK4JAZXOTX"}],"key":"M6Nn9Hb2aE"},{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Yilmaz, K. K., Gupta, H. V., & Wagener, T. (2008). A process‐based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model. Water Resources Research, 44(9).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"eD8msEOiID"}],"key":"BtPfloHxPN"}],"key":"X82xspGb1N"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"percent bias in FDC low-segment volume (Q0-Q30)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MUYqJz6hSY"}],"key":"tRBH4rLLzt"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Yilmaz, K. K., Gupta, H. V., & Wagener, T. (2008). A process‐based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model. Water Resources Research, 44(9).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IapVGJs8IO"}],"key":"Adj5X1xIre"}],"key":"yoo3BMFn8C"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"percent bias in FDC high-segment volume (Q98-Q100)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IB2rMzMKbU"}],"key":"hIaSYvGiRW"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Yilmaz, K. K., Gupta, H. V., & Wagener, T. (2008). A process‐based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model. Water Resources Research, 44(9).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"heOJRw37iS"}],"key":"zQrF2HwUXI"}],"key":"fGt4cSXOsG"}],"key":"MiydkWXw7L"}],"key":"td3edNwpOF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pBiasFMS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jgDVUUVm88"}],"identifier":"pbiasfms","label":"pBiasFMS","html_id":"pbiasfms","implicit":true,"key":"p74J2idOuT"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This is the percent bias of the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jgx8Xb2OLo"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"slope","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZlrIhd8VMq"}],"key":"CwMZSoTLun"},{"type":"text","value":" of the FDC in the mid-segment part of the curve. See equation A2 of Yilmaz","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CJyExW60x1"}],"key":"VesXlBADtt"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"inlineMath","value":"\\%BiasFMS = 100 × \\cfrac{ [log(QS_{m1}) - log(QS_{m2})] - [log(QO_{m1}) - log(QO_{m2})] }{ [log(QO_{m1}) - log(QO_{m2})] }","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">%</mi><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mi>F</mi><mi>M</mi><mi>S</mi><mo>=</mo><mn>100</mn><mo>×</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>S</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>S</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>−</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\%BiasFMS = 100 × \\cfrac{ [log(QS_{m1}) - log(QS_{m2})] - [log(QO_{m1}) - log(QO_{m2})] }{ [log(QO_{m1}) - log(QO_{m2})] }</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">%</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">ia</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">FMS</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.526em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.59em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)]</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.74em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span></span></span></span>","key":"RMzuSmCYHe"}],"key":"TETFTkMIKo"}],"key":"SpI2tmmV9z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def pBiasFMS(obs, sim) -> float:\n    \"\"\"\n    calculates percent bias of the slope the mid-segment of FDC.\n\n    Returns:\n        float: percent bias for values in exceedence probability range 0.2-0.7\n    \"\"\"\n    # Exceedence = 1 - percentile  ;  percentile = 1 - exceedence\n    # mid-segment slope is defined as those observations with flow exceedence probabilities between 20% and 70%.\n    # This leads to percentiles/quantiles of 30% and 80% to establish the cut-offs\n    QO_m1, QO_m2 = np.quantile(obs, [0.30, 0.80])\n    QS_m1, QS_m2 = np.quantile(sim, [0.30, 0.80])\n    m = np.log(QS_m1) - np.log(QS_m2)\n    o = np.log(QO_m1) - np.log(QO_m2)\n    return 100 * (m - o ) / o","key":"OmiQWfe7jv"},{"type":"outputs","id":"Cdx_aCuOWeUxt9Puylj9Z","children":[],"key":"aNY5umC3gm"}],"key":"xSpf7gNKHa"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pBiasFLV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zDXR90otox"}],"identifier":"pbiasflv","label":"pBiasFLV","html_id":"pbiasflv","implicit":true,"key":"a5hHwQII1F"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Percent bias in low-flow segment ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TQp1wdwfXB"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"volume","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PnGNVneQez"}],"key":"rLTb2GNtAR"},{"type":"text","value":".  Note that in low flow segment, a log transform is used to\nincrease sensitivity to very low flows. See equation A4 from Yilmaz.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oD1GvMV1gJ"}],"key":"F96M0z28Sz"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineMath","value":"\\%BiasFLV = -100 × \\cfrac{\n    \\displaystyle\\sum_{l=1}^L[log(QS_l) - log(QS_L)] - \n    \\displaystyle\\sum_{l=1}^L[log(QO_l) - log(QO_l)]\n    }{\n        \\displaystyle\\sum_{l=1}^L[log(QO_l) - log(QO_L)]\n    }","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">%</mi><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mi>F</mi><mi>L</mi><mi>V</mi><mo>=</mo><mo>−</mo><mn>100</mn><mo>×</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mo stretchy=\"false\">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>S</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>S</mi><mi>L</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>−</mo><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mo stretchy=\"false\">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mstyle></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mo stretchy=\"false\">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>O</mi><mi>L</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mstyle></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\%BiasFLV = -100 × \\cfrac{\n    \\displaystyle\\sum_{l=1}^L[log(QS_l) - log(QS_L)] - \n    \\displaystyle\\sum_{l=1}^L[log(QO_l) - log(QO_l)]\n    }{\n        \\displaystyle\\sum_{l=1}^L[log(QO_l) - log(QO_L)]\n    }</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">%</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">ia</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">100</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:6.5409em;vertical-align:-3.0204em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5204em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)]</span></span></span><span style=\"top:-4.0583em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-5.5204em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.0204em;\"><span></span></span></span></span></span><span></span></span></span></span></span>","key":"SEyn7WEACg"}],"key":"TttpYMlNyt"}],"key":"Ls8OM1bpgE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def pBiasFLV(obs, sim) -> float:\n    \"\"\"\n    calculates percent bias over the low-flow segment volume.\n    Note that for low-flow observations a log transform is done before the\n    pbias calculation.\n\n    Returns:\n        float: percent bias for values in exceedence probability range 0.7-1.0\n    \"\"\"\n    # Exceedence = 1 - percentile  ;  percentile = 1 - exceedence\n    # Low-Volume is defined as those observations with flow exceedence probabilities between 70% and 100%.\n    # This leads to percentiles/quantiles of 0% and 30% to establish the cut-offs\n    _, QO_L = np.quantile(obs, [0.0, 0.30])\n    _, QS_L = np.quantile(sim, [0.0, 0.30])\n    idx = (obs <= QO_L) # defines boolean selector index\n    QS_l = sim[idx]\n    QO_l = obs[idx]\n    m = np.sum(np.log(QS_l) - np.log(QS_L))\n    o = np.sum(np.log(QO_l) - np.log(QO_L))\n    return -100 * (( m - o ) / o)\n","key":"nnllyryvLK"},{"type":"outputs","id":"uI9ENKKiFSw1F7zMLv0aF","children":[],"key":"zOpGM8XgYw"}],"key":"hZ89bno9AU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pBiasFHV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qlVl4AxqH4"}],"identifier":"pbiasfhv","label":"pBiasFHV","html_id":"pbiasfhv","implicit":true,"key":"MtsdMLnTQE"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Percent bias in high-flow segment ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sdkovondhR"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"volume","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dgeRJqW6Xp"}],"key":"Xh4GoKYbzx"},{"type":"text","value":".  See equation A3 of Yilmaz","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AGw7K8VEGh"}],"key":"JgLeEC0TMx"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineMath","value":"\\%BiasFHV = 100 × \\cfrac{\n    \\displaystyle\\sum_{h=1}^H(QS_h - QO_h)\n    }{\n    \\displaystyle\\sum_{h=1}^H QO_h\n    }","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">%</mi><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mi>F</mi><mi>H</mi><mi>V</mi><mo>=</mo><mn>100</mn><mo>×</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>H</mi></munderover><mo stretchy=\"false\">(</mo><mi>Q</mi><msub><mi>S</mi><mi>h</mi></msub><mo>−</mo><mi>Q</mi><msub><mi>O</mi><mi>h</mi></msub><mo stretchy=\"false\">)</mo></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>H</mi></munderover><mi>Q</mi><msub><mi>O</mi><mi>h</mi></msub></mstyle></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\%BiasFHV = 100 × \\cfrac{\n    \\displaystyle\\sum_{h=1}^H(QS_h - QO_h)\n    }{\n    \\displaystyle\\sum_{h=1}^H QO_h\n    }</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">%</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">ia</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:6.5409em;vertical-align:-3.0204em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5204em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-4.0583em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-5.5204em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.0204em;\"><span></span></span></span></span></span><span></span></span></span></span></span>","key":"lbkjlCqNHP"}],"key":"H1cAg4dPMO"}],"key":"L0D04arDNT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def pBiasFHV(obs, sim) -> float:\n    \"\"\"\n    calculates percent bias over the high-flow segment volume.\n\n    Returns:\n        float:\n    \"\"\"\n    # Exceedence = 1 - percentile  ; percentile = 1 - exceedence\n    # 'High-Volume' is defined as those observations with flow exceedence probabilities between 0 and 2%.\n    # This leads to percentiles/quantiles of 98% and 100% to establish the cut-offs\n    #\n    minval, maxval = np.quantile(obs, [0.98, 1.0])\n    idx = (obs >= minval) & (obs <= maxval)\n    QS_h = sim[idx]\n    QO_h = obs[idx]\n    # standard pbias over these observations\n    return 100 * ( (QS_h - QO_h).sum() / QO_h.sum() )","key":"m42zWuzgWR"},{"type":"outputs","id":"FlJXRlstZ5Rf2bwieJViF","children":[],"key":"cOkLVGmAeU"}],"key":"RY41tmPNi8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Flow Duration Curve Plotting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ifX3Tb2qeF"}],"identifier":"flow-duration-curve-plotting","label":"Flow Duration Curve Plotting","html_id":"flow-duration-curve-plotting","implicit":true,"key":"YSDzke7GzH"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We also allow for plots of the FDC, highlighting the segment-specific metric being calculated.\nSee the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MPRsHEZvz7"},{"type":"link","url":"/evaluation/tutorials/stats-demos/usage-stdsuite-v1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"usage document","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"csF2seNOi4"}],"urlSource":"./tutorials/stats_demos/Usage_StdSuite_v1.ipynb","dataUrl":"/evaluation.tutorials.stats-demos.usage-stdsuite-v1.json","internal":true,"protocol":"file","key":"cpCybRDKBi"},{"type":"text","value":" to see how this might be called.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zSGUCL09MM"}],"key":"d1XU9vbJBW"}],"key":"hsOFFBJTaD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def FDCplot(obs, sim, ax, segment='mid', fill=False):\n    \"\"\"\n    Given an axes within a matplotlib.plot figure, populate it with\n    artists to show the FDC curves for this dataset (modeled and observed).\n    Optionally fills the space between curves.\n    Parameters\n    ----------\n    obs : observed values\n    sim : simulated/modeled values\n    ax : Axes\n        The specific axes within a fig to draw upon\n    segment : str, optional\n        Which segment of the FDC do you want to highlight? ['lo', 'mid', 'hi'], by default 'mid'\n    fill : bool, optional\n        : Do you want to 'fill_between' the observed and modeled curves?. by default False\n    Returns\n    -------\n    Axes\n        The same axes we were passed in.  Likely ignored.\n    \"\"\"\n    obs_sorted = np.sort(obs)[::-1]\n    mod_sorted = np.sort(sim)[::-1]\n    exceedence = np.arange(1.,len(obs_sorted)+1) / len(obs_sorted)\n\n    ax.set_xlabel(\"Exceedence [%]\", fontsize=6)\n    ax.set_ylabel(\"Flow Rate\", fontsize=6)\n    # NOTE: no units are specified in this label -- because we don't know enough about\n    # the source data.  If the user wants units in the y axis labels, they can call\n    # ax.set_ylabel(\"Flow Rate $m^3 / s$\") (or similar) afterwards to manipulate it.\n    ax.set_yscale('log')\n\n    if segment not in ['mid', 'lo', 'hi']:\n        logging.debug(\"Invalid segment identifier '%s'. Options are ['mid', 'lo', 'hi']\", segment)\n        segment = 'mid'\n\n    if segment == 'mid':\n        pb=pBiasFMS(obs, sim)\n        ax.axvline(x = 20, color = 'b', lw=0.25)\n        ax.axvline(x = 70, color = 'b', lw=0.25)\n        ax.axvspan(20, 70, facecolor='lightgrey', alpha=0.25)\n        ax.text( 0.45 , 0.05, \"Mid-Segment\",\n            verticalalignment='bottom', horizontalalignment='center',\n            transform=ax.transAxes,\n            color='b', fontsize=4)\n        ax.text( 0.45 , 0.01, f\"pBiasFMS= {pb:.4f}\",\n            verticalalignment='bottom', horizontalalignment='center',\n            transform=ax.transAxes,\n            color='b', fontsize=3)\n\n    if segment == 'lo':\n        pb=pBiasFLV(obs, sim)\n        ax.axvline(x = 70, color = 'b', lw=0.25)\n        ax.axvline(x = 100, color = 'b', lw=0.25)\n        ax.axvspan(70, 100, facecolor='lightgrey', alpha=0.25)\n        ax.text( 0.99 , 0.05, \"Low-Flow\",\n            verticalalignment='bottom', horizontalalignment='right',\n            transform=ax.transAxes,\n            color='b', fontsize=4)\n        ax.text( 0.99 , 0.01, f\"pBiasFLV= {pb:.4f}\",\n            verticalalignment='bottom', horizontalalignment='right',\n            transform=ax.transAxes,\n            color='b', fontsize=3)\n\n    if segment == 'hi':\n        pb=pBiasFHV(obs, sim)\n        ax.axvline(x = 0, color = 'b', lw=0.25)\n        ax.axvline(x = 2, color = 'b', lw=0.25)\n        ax.axvspan(0, 2, facecolor='lightgrey', alpha=0.25)\n        ax.text( 0.02 , 0.05, \"High-Flow\",\n            verticalalignment='bottom', horizontalalignment='left',\n            transform=ax.transAxes,\n            color='b', fontsize=4)\n        ax.text( 0.02 , 0.01, f\"pBiasFHV= {pb:.4f}\",\n            verticalalignment='bottom', horizontalalignment='left',\n            transform=ax.transAxes,\n            color='b', fontsize=3)\n\n    ax.plot(exceedence*100, mod_sorted, color='r', lw=0.33, label='Modeled')\n    ax.plot(exceedence*100, obs_sorted, color='k', lw=0.33, label='Observed')\n    if fill:\n        ax.fill_between(exceedence*100, obs_sorted, mod_sorted, lw=0.33, color='r', hatch='//////', alpha=0.0625)\n    ax.legend(loc='upper right', fontsize=6, handlelength=3)\n    ax.grid(linewidth=0.05, dashes=[8,12], color='k', which=\"both\", axis='y')\n    ax.grid(linewidth=0.1, dashes=[16, 8], which='major', axis='x')\n    ax.set_xlim((0, 100))\n    ax.tick_params(which='both', labelsize=4, width=0.25, length=2, pad=1)\n    _ = [ax.spines[axis].set_linewidth(0.2) for axis in ['top','bottom','left','right']]\n\n    return ax","key":"qWGHzKR4k4"},{"type":"outputs","id":"gRm5f0MmeoYw493WzafAz","children":[],"key":"X1PAudH3jA"}],"key":"v6SzG2AI5w"}],"key":"ti2EhhuAvn"},"references":{"cite":{"order":["Towler2023Benchmarking","Pushpalatha_2012"],"data":{"Towler2023Benchmarking":{"label":"Towler2023Benchmarking","enumerator":"1","doi":"10.5194/hess-27-1809-2023","html":"Towler, E., Foks, S. S., Dugger, A. L., Dickinson, J. E., Essaid, H. I., Gochis, D., Viger, R. J., & Zhang, Y. (2023). Benchmarking high-resolution hydrologic model  performance of long-term retrospective streamflow  simulations in the contiguous United States. <i>Hydrology and Earth System Sciences</i>, <i>27</i>(9), 1809–1825. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5194/hess-27-1809-2023\">10.5194/hess-27-1809-2023</a>","url":"https://doi.org/10.5194/hess-27-1809-2023"},"Pushpalatha_2012":{"label":"Pushpalatha_2012","enumerator":"2","doi":"10.1016/j.jhydrol.2011.11.055","html":"Pushpalatha, R., Perrin, C., Moine, N. L., & Andréassian, V. (2012). A review of efficiency criteria suitable for evaluating low-flow simulations. <i>Journal of Hydrology</i>, <i>420–421</i>, 171–182. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/j.jhydrol.2011.11.055\">10.1016/j.jhydrol.2011.11.055</a>","url":"https://doi.org/10.1016/j.jhydrol.2011.11.055"}}}},"footer":{"navigation":{"prev":{"title":"D-Score Suite (v1) Benchmark -- Usage Examples","url":"/evaluation/tutorials/stats-demos/usage-dscore-suite-v1","group":"Model Evaluation"},"next":{"title":"Standard Suite (v1) Metrics -- Usage Examples","url":"/evaluation/tutorials/stats-demos/usage-stdsuite-v1","group":"Model Evaluation"}}},"domain":"http://localhost:3005"}